{% extends 'base.html' %}
{% block title %}采购申请详情 - BetterLaser ERP{% endblock %}
{% block content %}
<div class="space-y-6">
    <div class="flex justify-between items-center">
        <h3 class="text-lg font-semibold">采购申请 {{ request.request_number }}</h3>
        <div class="flex gap-2">
            {% if request.status == 'draft' %}
            <form method="post" action="{% url 'purchase:request_submit' request.pk %}">
                {% csrf_token %}
                <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">提交审核</button>
            </form>
            {% endif %}
            {% if request.status == 'submitted' %}
            <form method="post" action="{% url 'purchase:request_approve' request.pk %}">
                {% csrf_token %}
                <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">审核通过</button>
            </form>
            {% endif %}
            {% if request.status == 'approved' and not request.converted_order %}
            <a href="{% url 'purchase:request_convert_to_order' request.pk %}" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">转采购订单</a>
            {% endif %}
        </div>
    </div>
    <div class="bg-white rounded-lg shadow p-6">
        <div class="grid grid-cols-3 gap-4">
            <div><span class="text-gray-600">申请部门:</span> <span class="font-medium">{{ request.department.name }}</span></div>
            <div><span class="text-gray-600">申请人:</span> <span class="font-medium">{{ request.requester.get_full_name }}</span></div>
            <div><span class="text-gray-600">状态:</span> <span class="font-medium">{{ request.get_status_display }}</span></div>
        </div>
    </div>
</div>
{% endblock %}