{% load static %}
{% load humanize %}
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}BetterLaser ERP ç³»ç»Ÿ{% endblock %}</title> <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect fill='%233b82f6' width='100' height='100' rx='15'/%3E%3Ctext x='50' y='70' text-anchor='middle' fill='white' font-size='50' font-weight='bold' font-family='sans-serif'%3EBL%3C/text%3E%3C/svg%3E"> <!-- ç«‹å³åº”ç”¨ä¸»é¢˜ï¼ˆé˜²æ­¢é—ªçƒï¼‰ -->
    <script>
        (function() {
            try {
                const validThemes = ['blue', 'yellow', 'red'];
                const defaultTheme = 'blue'; // è¿ç§»é€»è¾‘ï¼šå¦‚æœæ—§çš„ 'theme' é”®å­˜åœ¨ä¸”æœ‰æ•ˆï¼ˆä¸æ˜¯ Django admin çš„å€¼ï¼‰ï¼Œè¿ç§»åˆ° 'erp_theme'
                const oldTheme = localStorage.getItem('theme');
                if (oldTheme && validThemes.includes(oldTheme) && !localStorage.getItem('erp_theme')) {
                    localStorage.setItem('erp_theme', oldTheme);
                    // ä¸åˆ é™¤æ—§é”®ï¼Œè®© Django admin ç»§ç»­ä½¿ç”¨
                } // ä¼˜å…ˆä½¿ç”¨å†…å­˜ä¸­ä¿å­˜çš„ä¸»é¢˜ï¼ˆé˜²æ­¢è¢«è¦†ç›–ï¼‰
                let themeToApply = window.__validTheme; // å¦‚æœå†…å­˜ä¸­æ²¡æœ‰ï¼Œå†è¯»å– localStorageï¼ˆä½¿ç”¨ erp_theme é¿å…ä¸ Django admin å†²çªï¼‰
                if (!themeToApply) {
                    const savedTheme = localStorage.getItem('erp_theme');
                    themeToApply = (savedTheme && validThemes.includes(savedTheme)) ? savedTheme : defaultTheme;
                } // åªåœ¨ä¸»é¢˜æ— æ•ˆæ—¶æ‰å†™å…¥é»˜è®¤ä¸»é¢˜ï¼ˆä¸è¦†ç›–ç°æœ‰æœ‰æ•ˆä¸»é¢˜ï¼‰
                const currentSaved = localStorage.getItem('erp_theme');
                if (!currentSaved || !validThemes.includes(currentSaved)) {
                    localStorage.setItem('erp_theme', themeToApply);
                } document.documentElement.setAttribute('data-theme', themeToApply);
                window.__validTheme = themeToApply;
            } catch (e) {
                document.documentElement.setAttribute('data-theme', 'blue');
            }
        })();
    </script> <!-- Tailwind CSSï¼ˆç¼–è¯‘åçš„ç‰ˆæœ¬ï¼‰ -->
    <link rel="stylesheet" href="{% static 'css/output.css' %}"> <!-- ä¸»é¢˜è‰²æ ·å¼ -->
    <style>
        :root {
            --theme-50: 239, 246, 255;
            --theme-100: 219, 234, 254;
            --theme-200: 191, 219, 254;
            --theme-300: 147, 197, 253;
            --theme-400: 96, 165, 250;
            --theme-500: 59, 130, 246;
            --theme-600: 37, 99, 235;
            --theme-700: 29, 78, 216;
            --theme-800: 30, 64, 175;
            --theme-900: 30, 58, 138;
        } [data-theme="blue"] {
            --theme-50: 239, 246, 255;
            --theme-100: 219, 234, 254;
            --theme-200: 191, 219, 254;
            --theme-300: 147, 197, 253;
            --theme-400: 96, 165, 250;
            --theme-500: 59, 130, 246;
            --theme-600: 37, 99, 235;
            --theme-700: 29, 78, 216;
            --theme-800: 30, 64, 175;
            --theme-900: 30, 58, 138;
        } [data-theme="yellow"] {
            --theme-50: 254, 252, 232;
            --theme-100: 254, 249, 195;
            --theme-200: 254, 240, 138;
            --theme-300: 253, 224, 71;
            --theme-400: 250, 204, 21;
            --theme-500: 234, 179, 8;
            --theme-600: 202, 138, 4;
            --theme-700: 161, 98, 7;
            --theme-800: 133, 77, 14;
            --theme-900: 113, 63, 18;
        } [data-theme="red"] {
            --theme-50: 254, 242, 242;
            --theme-100: 254, 226, 226;
            --theme-200: 254, 202, 202;
            --theme-300: 252, 165, 165;
            --theme-400: 248, 113, 113;
            --theme-500: 239, 68, 68;
            --theme-600: 220, 38, 38;
            --theme-700: 185, 28, 28;
            --theme-800: 153, 27, 27;
            --theme-900: 127, 29, 29;
        } /* ä½¿ç”¨ä¸»é¢˜è‰²çš„ç±» - Background */
        .bg-theme-50 { background-color: rgb(var(--theme-50)); }
        .bg-theme-100 { background-color: rgb(var(--theme-100)); }
        .bg-theme-200 { background-color: rgb(var(--theme-200)); }
        .bg-theme-300 { background-color: rgb(var(--theme-300)); }
        .bg-theme-400 { background-color: rgb(var(--theme-400)); }
        .bg-theme-500 { background-color: rgb(var(--theme-500)); }
        .bg-theme-600 { background-color: rgb(var(--theme-600)); }
        .bg-theme-700 { background-color: rgb(var(--theme-700)); }
        .bg-theme-800 { background-color: rgb(var(--theme-800)); }
        .bg-theme-900 { background-color: rgb(var(--theme-900)); } /* Hover Background */
        .hover\:bg-theme-50:hover { background-color: rgb(var(--theme-50)); }
        .hover\:bg-theme-100:hover { background-color: rgb(var(--theme-100)); }
        .hover\:bg-theme-200:hover { background-color: rgb(var(--theme-200)); }
        .hover\:bg-theme-300:hover { background-color: rgb(var(--theme-300)); }
        .hover\:bg-theme-400:hover { background-color: rgb(var(--theme-400)); }
        .hover\:bg-theme-500:hover { background-color: rgb(var(--theme-500)); }
        .hover\:bg-theme-600:hover { background-color: rgb(var(--theme-600)); }
        .hover\:bg-theme-700:hover { background-color: rgb(var(--theme-700)); }
        .hover\:bg-theme-800:hover { background-color: rgb(var(--theme-800)); }
        .hover\:bg-theme-900:hover { background-color: rgb(var(--theme-900)); } /* Text Color */
        .text-theme-50 { color: rgb(var(--theme-50)); }
        .text-theme-100 { color: rgb(var(--theme-100)); }
        .text-theme-200 { color: rgb(var(--theme-200)); }
        .text-theme-300 { color: rgb(var(--theme-300)); }
        .text-theme-400 { color: rgb(var(--theme-400)); }
        .text-theme-500 { color: rgb(var(--theme-500)); }
        .text-theme-600 { color: rgb(var(--theme-600)); }
        .text-theme-700 { color: rgb(var(--theme-700)); }
        .text-theme-800 { color: rgb(var(--theme-800)); }
        .text-theme-900 { color: rgb(var(--theme-900)); } /* Hover Text */
        .hover\:text-theme-50:hover { color: rgb(var(--theme-50)); }
        .hover\:text-theme-100:hover { color: rgb(var(--theme-100)); }
        .hover\:text-theme-200:hover { color: rgb(var(--theme-200)); }
        .hover\:text-theme-300:hover { color: rgb(var(--theme-300)); }
        .hover\:text-theme-400:hover { color: rgb(var(--theme-400)); }
        .hover\:text-theme-500:hover { color: rgb(var(--theme-500)); }
        .hover\:text-theme-600:hover { color: rgb(var(--theme-600)); }
        .hover\:text-theme-700:hover { color: rgb(var(--theme-700)); }
        .hover\:text-theme-800:hover { color: rgb(var(--theme-800)); }
        .hover\:text-theme-900:hover { color: rgb(var(--theme-900)); } /* Border Color */
        .border-theme-50 { border-color: rgb(var(--theme-50)); }
        .border-theme-100 { border-color: rgb(var(--theme-100)); }
        .border-theme-200 { border-color: rgb(var(--theme-200)); }
        .border-theme-300 { border-color: rgb(var(--theme-300)); }
        .border-theme-400 { border-color: rgb(var(--theme-400)); }
        .border-theme-500 { border-color: rgb(var(--theme-500)); }
        .border-theme-600 { border-color: rgb(var(--theme-600)); }
        .border-theme-700 { border-color: rgb(var(--theme-700)); }
        .border-theme-800 { border-color: rgb(var(--theme-800)); }
        .border-theme-900 { border-color: rgb(var(--theme-900)); } /* Ring/Shadow */
        .ring-theme-50 { --tw-ring-color: rgb(var(--theme-50)); }
        .ring-theme-100 { --tw-ring-color: rgb(var(--theme-100)); }
        .ring-theme-200 { --tw-ring-color: rgb(var(--theme-200)); }
        .ring-theme-300 { --tw-ring-color: rgb(var(--theme-300)); }
        .ring-theme-400 { --tw-ring-color: rgb(var(--theme-400)); }
        .ring-theme-500 { --tw-ring-color: rgb(var(--theme-500)); }
        .ring-theme-600 { --tw-ring-color: rgb(var(--theme-600)); }
        .ring-theme-700 { --tw-ring-color: rgb(var(--theme-700)); }
        .ring-theme-800 { --tw-ring-color: rgb(var(--theme-800)); }
        .ring-theme-900 { --tw-ring-color: rgb(var(--theme-900)); } /* Focus Ring */
        .focus\:ring-theme-50:focus { --tw-ring-color: rgb(var(--theme-50)); }
        .focus\:ring-theme-100:focus { --tw-ring-color: rgb(var(--theme-100)); }
        .focus\:ring-theme-200:focus { --tw-ring-color: rgb(var(--theme-200)); }
        .focus\:ring-theme-300:focus { --tw-ring-color: rgb(var(--theme-300)); }
        .focus\:ring-theme-400:focus { --tw-ring-color: rgb(var(--theme-400)); }
        .focus\:ring-theme-500:focus { --tw-ring-color: rgb(var(--theme-500)); }
        .focus\:ring-theme-600:focus { --tw-ring-color: rgb(var(--theme-600)); }
        .focus\:ring-theme-700:focus { --tw-ring-color: rgb(var(--theme-700)); }
        .focus\:ring-theme-800:focus { --tw-ring-color: rgb(var(--theme-800)); }
        .focus\:ring-theme-900:focus { --tw-ring-color: rgb(var(--theme-900)); } /* Focus Border */
        .focus\:border-theme-50:focus { border-color: rgb(var(--theme-50)); }
        .focus\:border-theme-100:focus { border-color: rgb(var(--theme-100)); }
        .focus\:border-theme-200:focus { border-color: rgb(var(--theme-200)); }
        .focus\:border-theme-300:focus { border-color: rgb(var(--theme-300)); }
        .focus\:border-theme-400:focus { border-color: rgb(var(--theme-400)); }
        .focus\:border-theme-500:focus { border-color: rgb(var(--theme-500)); }
        .focus\:border-theme-600:focus { border-color: rgb(var(--theme-600)); }
        .focus\:border-theme-700:focus { border-color: rgb(var(--theme-700)); }
        .focus\:border-theme-800:focus { border-color: rgb(var(--theme-800)); }
        .focus\:border-theme-900:focus { border-color: rgb(var(--theme-900)); } /* åŠ¨æ€ä¸»é¢˜è‰²æŒ‰é’®æ ·å¼ */
        .btn-primary {
            background-color: rgb(var(--theme-600));
            color: white;
        }
        .btn-primary:hover {
            background-color: rgb(var(--theme-700));
        }
        .btn-primary:focus {
            --tw-ring-color: rgb(var(--theme-500));
        } .btn-secondary {
            background-color: rgb(var(--theme-50));
            color: rgb(var(--theme-700));
            border: 1px solid rgb(var(--theme-200));
        }
        .btn-secondary:hover {
            background-color: rgb(var(--theme-100));
        }
        .btn-secondary:focus {
            --tw-ring-color: rgb(var(--theme-500));
        }
    </style> <!-- Alpine.js -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script> <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"> <!-- Tom Select - å¢å¼ºå‹ä¸‹æ‹‰æ¡†ï¼ˆæ”¯æŒæœç´¢ï¼‰ -->
    <link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script> <!-- Custom CSS -->
    <style>
        [x-cloak] { display: none !important; } /* Tom Select å…¨å±€åŸç”Ÿé£æ ¼æ ·å¼ */
        .ts-wrapper {
            width: 100%;
            background: transparent !important;
            border: none !important;
            box-shadow: none !important;
            padding: 0 !important;
        } .ts-wrapper .ts-control {
            min-height: 40px !important;
            height: 40px !important;
            padding: 0 12px !important;
            border: 1px solid #d1d5db !important;
            border-radius: 0.5rem !important;
            background-color: white !important;
            cursor: pointer !important;
            box-shadow: none !important;
        } .ts-wrapper.focus .ts-control {
            border-color: rgb(var(--theme-500)) !important;
            box-shadow: 0 0 0 2px rgba(var(--theme-500), 0.2) !important;
            outline: none !important;
        } .ts-wrapper .ts-control input {
            height: 38px !important;
            line-height: 38px !important;
            cursor: text !important;
            width: 100% !important;
        } .ts-wrapper.single .ts-control {
            padding-right: 36px !important;
            display: flex !important;
            align-items: center !important;
        } /* å•é€‰æ¨¡å¼ä¸‹éšè— inputï¼ˆæœç´¢æ—¶è‡ªåŠ¨æ˜¾ç¤ºï¼‰ */
        .ts-wrapper.single .ts-control input {
            position: absolute !important;
            opacity: 0 !important;
            z-index: -1 !important;
        } /* æœç´¢æ—¶æ˜¾ç¤º input */
        .ts-wrapper.single.input-active .ts-control input {
            position: relative !important;
            opacity: 1 !important;
            z-index: 1 !important;
        } /* æœç´¢æ—¶éšè— item */
        .ts-wrapper.single.input-active .ts-control .item {
            display: none !important;
        } /* å•é€‰æ¨¡å¼ä¸‹çš„é€‰ä¸­é¡¹æ ·å¼ */
        .ts-wrapper.single .ts-control .item {
            background: transparent !important;
            border: none !important;
            padding: 0 !important;
            color: #374151 !important;
            font-size: 1rem !important;
            line-height: 38px !important;
        } .ts-wrapper.single .ts-control::after {
            content: '' !important;
            position: absolute !important;
            right: 12px !important;
            top: 50% !important;
            transform: translateY(-50%) !important;
            border-left: 5px solid transparent !important;
            border-right: 5px solid transparent !important;
            border-top: 6px solid #6b7280 !important;
            pointer-events: none !important;
            z-index: 3 !important;
        } .ts-wrapper.single.dropdown-active .ts-control::after {
            border-top: 0 !important;
            border-bottom: 6px solid #6b7280 !important;
        } .ts-wrapper .ts-dropdown {
            border: 1px solid #d1d5db !important;
            border-radius: 0.5rem !important;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06) !important;
            margin-top: 4px !important;
        } .ts-wrapper .ts-dropdown .option {
            padding: 8px 12px !important;
            cursor: pointer !important;
            min-height: 36px !important;
        } .ts-wrapper .ts-dropdown .option:empty::before {
            content: '\00a0' !important;  /* ä¸æ¢è¡Œç©ºæ ¼ï¼Œç¡®ä¿ç©ºé€‰é¡¹æœ‰é«˜åº¦ */
        } .ts-wrapper .ts-dropdown .option.active {
            background-color: rgb(var(--theme-50)) !important;
            color: rgb(var(--theme-700)) !important;
        } .ts-wrapper .ts-dropdown .option:hover {
            background-color: #f3f4f6 !important;
        } /* éšè—æ¸…é™¤æŒ‰é’® */
        .ts-wrapper .clear-button {
            display: none !important;
        } /* Sidebar transition */
        .sidebar-transition {
            transition: width 0.2s ease-in-out;
        } /* å±•å¼€çŠ¶æ€çš„èœå•é¡¹æ ·å¼ */
        nav a, nav button {
            height: 3rem !important;  /* 48px ç»Ÿä¸€é«˜åº¦ */
            margin: 0.125rem 0 !important;  /* ä¸Šä¸‹2pxé—´è· */
            padding-left: 0.875rem !important;  /* 14px */
            padding-right: 0.875rem !important;  /* 14px */
            padding-top: 0 !important;
            padding-bottom: 0 !important;
            border-radius: 0.5rem !important;  /* 8pxåœ†è§’ */
            transition: all 0.2s;
            display: flex !important;
            align-items: center !important;
        } nav a:hover, nav button:hover {
            transform: translateX(2px);  /* è½»å¾®å³ç§» */
        } /* å›¾æ ‡æ ·å¼ - å›ºå®šå®½åº¦ç¡®ä¿å¯¹é½ */
        nav a i, nav button i {
            font-size: 1.25rem !important;  /* 20px */
            color: #6b7280;  /* ç°è‰² */
            transition: color 0.2s;
            width: 1.75rem !important;  /* 28px å›ºå®šå®½åº¦ */
            min-width: 1.75rem !important;  /* æœ€å°å®½åº¦ */
            height: 1.25rem !important;  /* 20px */
            display: inline-flex !important;
            align-items: center;
            justify-content: center;
            margin-right: 0.75rem !important;  /* 12px å³è¾¹è· */
        } nav a:hover i, nav button:hover i {
            color: #3b82f6;  /* hoverè“è‰² */
        } /* è¦†ç›–Tailwindçš„å›¾æ ‡å°ºå¯¸ç±» */
        nav a i.w-5, nav button i.w-5 {
            width: 1.75rem !important;
        } nav a i.h-5, nav button i.h-5 {
            height: 1.25rem !important;
        } /* è¦†ç›– mr-3 å’Œ mr-0 */
        nav a i.mr-3, nav button i.mr-3,
        nav a i.mr-0, nav button i.mr-0 {
            margin-right: 0.75rem !important;
        } /* å­èœå•æ ·å¼ */
        .submenu {
            margin-top: 0.25rem !important;  /* 4px é¡¶éƒ¨é—´è· */
            margin-left: 0 !important;  /* ç§»é™¤å·¦è¾¹è·ï¼Œç”¨paddingæ§åˆ¶ */
            padding-left: 0 !important;
        } .submenu a {
            height: 2.5rem !important;  /* 40px */
            margin: 0.125rem 0 !important;
            padding-left: 3.25rem !important;  /* 52px ç¼©è¿› */
            padding-right: 0.875rem !important;
            padding-top: 0 !important;
            padding-bottom: 0 !important;
            border-radius: 0.375rem !important;  /* 6px ç¨å°åœ†è§’ */
            font-size: 0.9375rem !important;  /* 15px */
            display: flex !important;
            align-items: center !important;
        } .submenu a:hover {
            background: #f3f4f6 !important;
            transform: translateX(4px);
        } /* èœå•æ–‡å­—æ ·å¼ */
        .menu-text {
            font-weight: 500;  /* ä¸­ç­‰ç²—ç»† */
            font-size: 1rem !important;  /* 16px */
            color: #374151;  /* æ·±ç°è‰² */
            transition: opacity 0.15s ease-in-out, width 0.15s ease-in-out;
            line-height: 1 !important;
            white-space: nowrap;  /* é˜²æ­¢æ–‡å­—æ¢è¡Œ */
            overflow: hidden;  /* éšè—æº¢å‡º */
        } nav a:hover .menu-text,
        nav button:hover .menu-text {
            color: #1f2937;  /* hoveræ·±è‰² */
        } /* ç®­å¤´å›¾æ ‡æ ·å¼ */
        .menu-chevron {
            font-size: 0.75rem !important;  /* 12px */
            color: #9ca3af;  /* æµ…ç°è‰² */
            transition: all 0.15s ease-in-out;
            margin-left: auto !important;  /* æ¨åˆ°æœ€å³ä¾§ */
            white-space: nowrap;
            overflow: hidden;
        } nav button:hover .menu-chevron {
            color: #3b82f6;  /* hoverè“è‰² */
        } /* å¯¼èˆªå®¹å™¨é—´è·ä¼˜åŒ– */
        nav {
            margin-top: 1rem !important;  /* 16px */
        } nav > div {
            padding-left: 0.75rem !important;  /* 12px */
            padding-right: 0.75rem !important;  /* 12px */
        } /* è¦†ç›–space-y-2 */
        nav > div > * {
            margin-top: 0 !important;
        } nav > div > *:not(:first-child) {
            margin-top: 0.125rem !important;  /* 2px */
        } /* Collapsed sidebar styles */
        .sidebar-collapsed .menu-text {
            opacity: 0;
            width: 0;
            overflow: hidden;
            visibility: hidden;
            transition: opacity 0.1s ease-in-out, width 0.1s ease-in-out, visibility 0s 0.1s;
        } .sidebar-collapsed .menu-chevron {
            opacity: 0;
            width: 0;
            overflow: hidden;
            visibility: hidden;
            transition: opacity 0.1s ease-in-out, width 0.1s ease-in-out, visibility 0s 0.1s;
        } .sidebar-collapsed .submenu {
            display: none !important;
        } /* æ”¶ç¼©çŠ¶æ€ä¸‹çš„åŸºç¡€å¸ƒå±€ */
        .sidebar-collapsed nav > div {
            padding: 0 0.5rem !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
        } /* ç»Ÿä¸€æ‰€æœ‰å¯¼èˆªé¡¹æ ·å¼ï¼ˆåŒ…æ‹¬ä»ªè¡¨ç›˜ï¼‰ - ä½¿ç”¨æ›´é«˜ä¼˜å…ˆçº§çš„é€‰æ‹©å™¨ */
        .sidebar-collapsed nav.mt-8 > div.px-3 > div.relative > a,
        .sidebar-collapsed nav.mt-8 > div.px-3 > div.relative > button {
            width: 40px !important;
            height: 40px !important;
            min-width: 40px !important;
            min-height: 40px !important;
            max-width: 40px !important;
            max-height: 40px !important;
            margin: 4px auto !important;
            padding: 0 !important;
            display: block !important;
            border-radius: 0.5rem !important;
            transition: all 0.2s !important;
            background: transparent !important;
            position: relative !important;
            box-sizing: border-box !important;
            text-align: center !important;
            line-height: 40px !important;
        } /* æ‚¬æµ®æ•ˆæœ */
        .sidebar-collapsed nav.mt-8 > div.px-3 > div.relative > a:hover,
        .sidebar-collapsed nav.mt-8 > div.px-3 > div.relative > button:hover {
            background-color: #f3f4f6 !important;
        } /* å…³é”®ä¿®å¤ï¼šéšè—æ”¶ç¼©çŠ¶æ€ä¸‹çš„æ–‡æœ¬å’Œç®­å¤´å›¾æ ‡ï¼Œç¡®ä¿å®ƒä»¬ä¸å‚ä¸å¸ƒå±€ */
        .sidebar-collapsed nav.mt-8 > div.px-3 > div.relative > a > span,
        .sidebar-collapsed nav.mt-8 > div.px-3 > div.relative > button > span {
            display: none !important;
        } /* éšè—èœå•æŒ‰é’®çš„ä¸‹æ‹‰ç®­å¤´ï¼ˆç¬¬äºŒä¸ªå›¾æ ‡ï¼‰ */
        .sidebar-collapsed nav.mt-8 > div.px-3 > div.relative > button > i.fa-chevron-down {
            display: none !important;
        } /* ç»Ÿä¸€å›¾æ ‡æ ·å¼ - åªé’ˆå¯¹ä¸»å›¾æ ‡ï¼ˆç¬¬ä¸€ä¸ª i æ ‡ç­¾ï¼‰ */
        .sidebar-collapsed nav.mt-8 > div.px-3 > div.relative > a > i.fas:first-of-type,
        .sidebar-collapsed nav.mt-8 > div.px-3 > div.relative > button > i.fas:first-of-type {
            font-size: 20px !important;
            line-height: 1 !important;
            margin: 0 !important;
            padding: 0 !important;
            color: #4b5563 !important;
            width: auto !important;
            height: auto !important;
            display: inline-block !important;
            vertical-align: middle !important;
        } .sidebar-collapsed nav.mt-8 > div.px-3 > div.relative > a:hover > i.fas:first-of-type,
        .sidebar-collapsed nav.mt-8 > div.px-3 > div.relative > button:hover > i.fas:first-of-type {
            color: #3b82f6 !important;
        } /* å¼ºåŠ›è¦†ç›–æ‰€æœ‰å¯èƒ½å½±å“å›¾æ ‡ä½ç½®çš„ç±» */
        .sidebar-collapsed nav.mt-8 i.fas.mr-3,
        .sidebar-collapsed nav.mt-8 i.fas.mr-0,
        .sidebar-collapsed nav.mt-8 i.mr-3,
        .sidebar-collapsed nav.mt-8 i.mr-0 {
            margin: 0 !important;
            margin-left: 0 !important;
            margin-right: 0 !important;
        } .sidebar-collapsed nav.mt-8 i.text-lg,
        .sidebar-collapsed nav.mt-8 i.fas.text-lg {
            font-size: 20px !important;
        } /* ç‰¹åˆ«é’ˆå¯¹ä»ªè¡¨ç›˜å›¾æ ‡ - ä½¿ç”¨æœ€é«˜ä¼˜å…ˆçº§ */
        .sidebar-collapsed nav.mt-8 > div.px-3 > div.relative > a[href*="dashboard"] > i.fa-tachometer-alt {
            margin: 0 !important;
            margin-left: 0 !important;
            margin-right: 0 !important;
            padding: 0 !important;
        } /* Tooltip for collapsed menu items */
        .menu-item-collapsed {
            position: relative;
        } .menu-item-collapsed:hover .menu-tooltip {
            display: block;
        } .menu-tooltip {
            display: none;
            position: absolute;
            left: 100%;
            top: 50%;
            transform: translateY(-50%);
            margin-left: 12px;
            padding: 8px 12px;
            background: #1f2937;
            color: white;
            border-radius: 6px;
            white-space: nowrap;
            font-size: 14px;
            z-index: 1000;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        } .menu-tooltip::before {
            content: '';
            position: absolute;
            right: 100%;
            top: 50%;
            transform: translateY(-50%);
            border: 6px solid transparent;
            border-right-color: #1f2937;
        } /* å­èœå•æ ·å¼ */
        .submenu {
            margin-top: 0.25rem !important;
            margin-left: 0 !important;
            padding-left: 0 !important;
        } .submenu a {
            height: 2.5rem !important;
            margin: 0.125rem 0 !important;
            padding-left: 3.25rem !important;
            padding-right: 0.875rem !important;
            padding-top: 0 !important;
            padding-bottom: 0 !important;
            border-radius: 0.375rem !important;
            font-size: 0.9375rem !important;
            display: flex !important;
            align-items: center !important;
        } .submenu a:hover {
            background: #f3f4f6 !important;
            transform: translateX(4px);
        } /* æ”¶ç¼©çŠ¶æ€ä¸‹çš„æ‚¬æµ®å­èœå• */
        .sidebar-collapsed .submenu-popup {
            display: none;
            position: absolute;
            left: 100%;
            top: 0;
            margin-left: 12px;
            width: fit-content !important;
            min-width: 120px !important;
            max-width: 180px !important;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            padding: 8px;
        } .sidebar-collapsed .menu-item-collapsed:hover .submenu-popup {
            display: block;
        } .submenu-popup a {
            display: block;
            padding: 10px 16px;
            color: #374151;
            text-decoration: none;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.2s;
            white-space: nowrap;
        } .submenu-popup a:hover {
            background: #f3f4f6;
            color: #1f2937;
        } /* è¦†ç›– HTML ä¸­çš„ Tailwind å›ºå®šå®½åº¦ç±» */
        .sidebar-collapsed .group:hover > div.w-48,
        .sidebar-collapsed .group:hover > div.w-56 {
            width: fit-content !important;
            min-width: 120px !important;
            max-width: 180px !important;
        }
    </style> {% block extra_css %}{% endblock %}
    {% block extra_head %}{% endblock %}
</head>
<body class="bg-gray-50 font-sans antialiased">
    <div id="app" x-data="{
        sidebarOpen: false,
        sidebarCollapsed: localStorage.getItem('sidebarCollapsed') === 'true',
        theme: (function() {
            const validThemes = ['blue', 'yellow', 'red']; // ä¼˜å…ˆä½¿ç”¨å†…å­˜ä¸­ä¿å­˜çš„ä¸»é¢˜
            if (window.__validTheme && validThemes.includes(window.__validTheme)) {
                return window.__validTheme;
            } // å…¶æ¬¡ä½¿ç”¨ localStorageï¼ˆä½¿ç”¨ erp_theme é¿å…ä¸ Django admin å†²çªï¼‰
            const saved = localStorage.getItem('erp_theme');
            if (saved && validThemes.includes(saved)) {
                return saved;
            } // æœ€åæ‰ç”¨é»˜è®¤å€¼
            return 'blue';
        })(), // èœå•å±•å¼€çŠ¶æ€ç®¡ç†
        menuState: {}, init() {
            // ç¡®ä¿ä¸»é¢˜åŒæ­¥åˆ° localStorage å’Œå†…å­˜
            if (this.theme) {
                localStorage.setItem('erp_theme', this.theme);
                window.__validTheme = this.theme;
            } // åº”ç”¨ä¸»é¢˜
            this.applyTheme(); // ç›‘å¬å…¶ä»–æ ‡ç­¾é¡µçš„ localStorage å˜åŒ–
            window.addEventListener('storage', (e) => {
                if (e.key === 'erp_theme' && e.newValue) {
                    const validThemes = ['blue', 'yellow', 'red'];
                    if (validThemes.includes(e.newValue)) {
                        this.theme = e.newValue;
                        window.__validTheme = e.newValue;
                        this.applyTheme();
                    }
                }
            }); // é¡µé¢å¸è½½å‰ç¡®ä¿ä¸»é¢˜å·²ä¿å­˜ï¼ˆé˜²æ­¢è·³è½¬åˆ° admin åä¸¢å¤±ï¼‰
            window.addEventListener('beforeunload', () => {
                if (this.theme) {
                    localStorage.setItem('erp_theme', this.theme);
                    window.__validTheme = this.theme;
                }
            }); // ä» localStorage åŠ è½½èœå•çŠ¶æ€
            const saved = localStorage.getItem('menuState');
            if (saved) {
                try {
                    this.menuState = JSON.parse(saved);
                } catch (e) {
                    this.menuState = {};
                }
            } // æ ¹æ®å½“å‰ URL è‡ªåŠ¨å±•å¼€å¯¹åº”çš„èœå•
            const path = window.location.pathname; // ğŸ”§ ä¿®å¤æ‰‹é£ç´bugï¼šå…ˆå…³é—­æ‰€æœ‰èœå•ï¼Œç¡®ä¿åªæœ‰ä¸€ä¸ªèœå•æ‰“å¼€
            Object.keys(this.menuState).forEach(key => {
                this.menuState[key] = false;
            }); // ç„¶åæ ¹æ®URLæ‰“å¼€å¯¹åº”çš„èœå•ï¼ˆæ³¨æ„ï¼šæ›´å…·ä½“çš„è·¯å¾„è¦å…ˆåŒ¹é…ï¼‰
            if (path.includes('/settings/database/')) {
                // æ•°æ®åº“ç®¡ç†å±äºç³»ç»Ÿç®¡ç†èœå•ï¼ˆä¼˜å…ˆåŒ¹é…å…·ä½“è·¯å¾„ï¼‰
                this.menuState.system = true;
            } else if (path.includes('/users/') || path.includes('/departments/') || path.includes('/admin/')) {
                this.menuState.system = true;
            } else if (path.includes('/sales/')) {
                this.menuState.sales = true;
            } else if (path.includes('/purchase/')) {
                this.menuState.purchase = true;
            } else if (path.includes('/inventory/import')) {
                // åº“å­˜å¯¼å…¥åŠåˆå§‹åŒ–å±äºåŸºç¡€è®¾ç½®èœå•
                this.menuState.basic_settings = true;
            } else if (path.includes('/inventory/')) {
                this.menuState.inventory = true;
            } else if (path.includes('/finance/')) {
                this.menuState.finance = true;
            } else if (path.includes('/customers/')) {
                // å®¢æˆ·ç®¡ç†å½’å±é”€å”®æ¨¡å—
                this.menuState.sales = true;
            } else if (path.includes('/suppliers/')) {
                // ä¾›åº”å•†ç®¡ç†å½’å±é‡‡è´­æ¨¡å—
                this.menuState.purchase = true;
            } else if (path.includes('/settings/') || path.includes('/products/')) {
                // å…¶ä»– settings è·¯å¾„å½’å±åŸºç¡€è®¾ç½®
                this.menuState.basic_settings = true;
            } // ä¿å­˜çŠ¶æ€
            this.saveMenuState();
        }, toggleMenu(menuName) {
            // è®°å½•å½“å‰èœå•çš„çŠ¶æ€
            const currentState = this.menuState[menuName]; // å…³é—­æ‰€æœ‰èœå•
            Object.keys(this.menuState).forEach(key => {
                this.menuState[key] = false;
            }); // åˆ‡æ¢å½“å‰èœå•çŠ¶æ€ï¼ˆå¦‚æœä¹‹å‰æ˜¯å…³é—­çš„å°±æ‰“å¼€ï¼Œå¦‚æœä¹‹å‰æ˜¯æ‰“å¼€çš„å°±å…³é—­ï¼‰
            this.menuState[menuName] = !currentState; this.saveMenuState();
        }, saveMenuState() {
            localStorage.setItem('menuState', JSON.stringify(this.menuState));
        }, toggleCollapse() {
            this.sidebarCollapsed = !this.sidebarCollapsed;
            localStorage.setItem('sidebarCollapsed', this.sidebarCollapsed);
        }, setTheme(themeName) {
            // éªŒè¯ä¸»é¢˜æ˜¯å¦æœ‰æ•ˆ
            const validThemes = ['blue', 'yellow', 'red'];
            if (!validThemes.includes(themeName)) {
                themeName = 'blue';
            } this.theme = themeName;
            localStorage.setItem('erp_theme', themeName);
            window.__validTheme = themeName;
            this.applyTheme();
        }, applyTheme() {
            document.documentElement.setAttribute('data-theme', this.theme);
        }
    }" class="flex h-screen bg-gray-50">
        <!-- Sidebar -->
        <div class="fixed inset-y-0 left-0 z-50 bg-white shadow-lg transform transition-all duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0 sidebar-transition"
             :class="{
                '-translate-x-full': !sidebarOpen,
                'translate-x-0': sidebarOpen,
                'w-56': !sidebarCollapsed,
                'w-16': sidebarCollapsed,
                'sidebar-collapsed': sidebarCollapsed
             }"> <!-- Logo -->
            <div class="flex items-center justify-center h-16 bg-theme-600 text-white relative">
                <h1 class="text-xl font-bold transition-all duration-200"
                    :class="{ 'opacity-0 w-0 overflow-hidden': sidebarCollapsed, 'opacity-100': !sidebarCollapsed }">
                    BetterLaser ERP
                </h1>
                <div x-show="sidebarCollapsed" x-cloak class="text-2xl font-bold">BL</div> <!-- Collapse Toggle Button -->
                <button class="btn btn-primary">
                    <i class="fas transition-transform duration-200"
                       :class="sidebarCollapsed ? 'fa-chevron-right' : 'fa-chevron-left'"></i>
                </button>
            </div> <!-- Navigation -->
            <nav class="mt-8">
                <div class="px-3 space-y-1">
                    <!-- Dashboard -->
                    <div class="relative">
                        <a href="{% url 'dashboard' %}"
                           class="flex items-center h-10 px-3 rounded-lg text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200"
                           :class="{ 'justify-center': sidebarCollapsed, 'w-full': !sidebarCollapsed, 'w-10': sidebarCollapsed }">
                            <i class="fas fa-tachometer-alt text-lg"
                               :class="{ 'mr-0': sidebarCollapsed, 'mr-3': !sidebarCollapsed }"></i>
                            <span class="font-medium transition-opacity duration-200"
                                  :class="{ 'opacity-0 w-0': sidebarCollapsed, 'opacity-100': !sidebarCollapsed }">
                                ä»ªè¡¨ç›˜
                            </span>
                        </a>
                    </div> <!-- Purchase Management -->
                    <div class="relative group">
                        <button @click="toggleMenu('purchase')"
                                :aria-expanded="menuState.purchase ? 'true' : 'false'"
                                aria-haspopup="true"
                                class="flex items-center h-10 w-full px-3 rounded-lg text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200"
                                :class="{ 'justify-center': sidebarCollapsed, 'w-full': !sidebarCollapsed, 'w-10': sidebarCollapsed }">
                            <i class="fas fa-shopping-cart text-lg" :class="{ 'mr-0': sidebarCollapsed, 'mr-3': !sidebarCollapsed }"></i>
                            <span class="font-medium flex-grow text-left transition-opacity duration-200"
                                  :class="{ 'opacity-0 w-0': sidebarCollapsed, 'opacity-100': !sidebarCollapsed }">é‡‡è´­ç®¡ç†</span>
                            <i class="fas fa-chevron-down text-sm transition-transform duration-200"
                               :class="{ 'opacity-0 w-0': sidebarCollapsed, 'opacity-100 ml-2': !sidebarCollapsed, 'rotate-180': menuState.purchase }"></i>
                        </button> <!-- Hover flyout for collapsed -->
                        <div x-show="sidebarCollapsed"
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 -translate-x-2"
                             x-transition:enter-end="opacity-100 translate-x-0"
                             class="absolute left-full top-0 ml-2 w-48 rounded-lg bg-white shadow-lg border border-gray-100 py-2 hidden group-hover:block">
                            <a href="{% url 'purchase:borrow_list' %}" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">é‡‡è´­å€Ÿç”¨</a>
                            <a href="/purchase/requests/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">é‡‡è´­ç”³è¯·</a>
                            <a href="/purchase/orders/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">é‡‡è´­è®¢å•</a>
                            <a href="/purchase/receipts/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">æ”¶è´§ç®¡ç†</a>
                            <a href="/purchase/returns/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">é‡‡è´­é€€è´§</a>
                            <a href="{% url 'suppliers:supplier_list' %}" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">ä¾›åº”å•†ç®¡ç†</a>
                            <a href="{% url 'purchase:order_report' %}" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">é‡‡è´­æŠ¥è¡¨</a>
                        </div> <!-- Accordion for expanded -->
                        <div x-show="!sidebarCollapsed && menuState.purchase"
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 -translate-y-2"
                             x-transition:enter-end="opacity-100 translate-y-0"
                             class="mt-1 pl-10 space-y-1">
                            <a href="{% url 'purchase:borrow_list' %}" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">é‡‡è´­å€Ÿç”¨</a>
                            <a href="/purchase/requests/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">é‡‡è´­ç”³è¯·</a>
                            <a href="/purchase/orders/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">é‡‡è´­è®¢å•</a>
                            <a href="/purchase/receipts/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">æ”¶è´§ç®¡ç†</a>
                            <a href="/purchase/returns/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">é‡‡è´­é€€è´§</a>
                            <a href="{% url 'suppliers:supplier_list' %}" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">ä¾›åº”å•†ç®¡ç†</a>
                            <a href="{% url 'purchase:order_report' %}" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">é‡‡è´­æŠ¥è¡¨</a>
                        </div>
                    </div> <!-- Sales Management -->
                    <div class="relative group">
                        <button @click="toggleMenu('sales')"
                                class="flex items-center h-10 w-full px-3 rounded-lg text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200"
                                :class="{ 'justify-center': sidebarCollapsed, 'w-full': !sidebarCollapsed, 'w-10': sidebarCollapsed }">
                            <i class="fas fa-chart-line text-lg"
                               :class="{ 'mr-0': sidebarCollapsed, 'mr-3': !sidebarCollapsed }"></i>
                            <span class="font-medium flex-grow text-left transition-opacity duration-200"
                                  :class="{ 'opacity-0 w-0': sidebarCollapsed, 'opacity-100': !sidebarCollapsed }">
                                é”€å”®ç®¡ç†
                            </span>
                            <i class="fas fa-chevron-down text-sm transition-transform duration-200"
                               :class="{
                                   'opacity-0 w-0': sidebarCollapsed,
                                   'opacity-100 ml-2': !sidebarCollapsed,
                                   'rotate-180': menuState.sales
                               }"></i>
                        </button> <!-- Hover submenu for collapsed state -->
                        <div x-show="sidebarCollapsed"
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 -translate-x-2"
                             x-transition:enter-end="opacity-100 translate-x-0"
                             class="absolute left-full top-0 ml-2 w-48 rounded-lg bg-white shadow-lg border border-gray-100 py-2 hidden group-hover:block">
                            <a href="{% url 'sales:loan_list' %}"
                               class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                                é”€å”®å€Ÿç”¨
                            </a>
                            <a href="{% url 'sales:quote_list' %}"
                               class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                                é”€å”®æŠ¥ä»·
                            </a>
                            <a href="{% url 'sales:order_list' %}"
                               class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                                é”€å”®è®¢å•
                            </a>
                            <a href="{% url 'sales:delivery_list' %}"
                               class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                                å‘è´§ç®¡ç†
                            </a>
                            <a href="{% url 'sales:return_list' %}"
                               class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                                é”€å”®é€€è´§
                            </a>
                            <a href="{% url 'customers:customer_list' %}"
                               class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                                å®¢æˆ·ç®¡ç†
                            </a>
                            <a href="{% url 'sales:order_report' %}"
                               class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                                é”€å”®æŠ¥è¡¨
                            </a>
                        </div> <!-- Accordion submenu for expanded state -->
                        <div x-show="!sidebarCollapsed && menuState.sales"
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 -translate-y-2"
                             x-transition:enter-end="opacity-100 translate-y-0"
                             class="mt-1 pl-10 space-y-1">
                            <a href="{% url 'sales:loan_list' %}"
                               class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                                é”€å”®å€Ÿç”¨
                            </a>
                            <a href="{% url 'sales:quote_list' %}"
                               class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                                é”€å”®æŠ¥ä»·
                            </a>
                            <a href="{% url 'sales:order_list' %}"
                               class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                                é”€å”®è®¢å•
                            </a>
                            <a href="{% url 'sales:delivery_list' %}"
                               class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                                å‘è´§ç®¡ç†
                            </a>
                            <a href="{% url 'sales:return_list' %}"
                               class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                                é”€å”®é€€è´§
                            </a>
                            <a href="{% url 'customers:customer_list' %}"
                               class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                                å®¢æˆ·ç®¡ç†
                            </a>
                            <a href="{% url 'sales:order_report' %}"
                               class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">
                                é”€å”®æŠ¥è¡¨
                            </a>
                        </div>
                    </div> <!-- Inventory Management -->
                    <div class="relative group">
                        <button @click="toggleMenu('inventory')"
                                :aria-expanded="menuState.inventory ? 'true' : 'false'"
                                aria-haspopup="true"
                                class="flex items-center h-10 w-full px-3 rounded-lg text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200"
                                :class="{ 'justify-center': sidebarCollapsed, 'w-full': !sidebarCollapsed, 'w-10': sidebarCollapsed }">
                            <i class="fas fa-boxes text-lg" :class="{ 'mr-0': sidebarCollapsed, 'mr-3': !sidebarCollapsed }"></i>
                            <span class="font-medium flex-grow text-left transition-opacity duration-200"
                                  :class="{ 'opacity-0 w-0': sidebarCollapsed, 'opacity-100': !sidebarCollapsed }">åº“å­˜ç®¡ç†</span>
                            <i class="fas fa-chevron-down text-sm transition-transform duration-200"
                               :class="{ 'opacity-0 w-0': sidebarCollapsed, 'opacity-100 ml-2': !sidebarCollapsed, 'rotate-180': menuState.inventory }"></i>
                        </button> <div x-show="sidebarCollapsed" class="absolute left-full top-0 ml-2 w-48 rounded-lg bg-white shadow-lg border border-gray-100 py-2 hidden group-hover:block">
                            <a href="/inventory/stocks/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº“å­˜æŸ¥è¯¢</a>
                            <a href="/inventory/transfers/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº“å­˜è°ƒæ‹¨</a>
                            <a href="/inventory/counts/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº“å­˜ç›˜ç‚¹</a>
                            <a href="/inventory/adjustments/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº“å­˜è°ƒæ•´</a>
                            <a href="{% url 'inventory:inventory_order_report' %}" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº“å­˜æŠ¥è¡¨</a>
                        </div> <div x-show="!sidebarCollapsed && menuState.inventory" class="mt-1 pl-10 space-y-1"
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 -translate-y-2"
                             x-transition:enter-end="opacity-100 translate-y-0">
                            <a href="/inventory/stocks/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº“å­˜æŸ¥è¯¢</a>
                            <a href="/inventory/transfers/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº“å­˜è°ƒæ‹¨</a>
                            <a href="/inventory/counts/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº“å­˜ç›˜ç‚¹</a>
                            <a href="/inventory/adjustments/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº“å­˜è°ƒæ•´</a>
                            <a href="{% url 'inventory:inventory_order_report' %}" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº“å­˜æŠ¥è¡¨</a>
                        </div>
                    </div> <!-- Finance Management -->
                    <div class="relative group">
                        <button @click="toggleMenu('finance')"
                                :aria-expanded="menuState.finance ? 'true' : 'false'"
                                aria-haspopup="true"
                                class="flex items-center h-10 w-full px-3 rounded-lg text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200"
                                :class="{ 'justify-center': sidebarCollapsed, 'w-full': !sidebarCollapsed, 'w-10': sidebarCollapsed }">
                            <i class="fas fa-calculator text-lg" :class="{ 'mr-0': sidebarCollapsed, 'mr-3': !sidebarCollapsed }"></i>
                            <span class="font-medium flex-grow text-left transition-opacity duration-200"
                                  :class="{ 'opacity-0 w-0': sidebarCollapsed, 'opacity-100': !sidebarCollapsed }">å¾€æ¥æ¬¾é¡¹</span>
                            <i class="fas fa-chevron-down text-sm transition-transform duration-200"
                               :class="{ 'opacity-0 w-0': sidebarCollapsed, 'opacity-100 ml-2': !sidebarCollapsed, 'rotate-180': menuState.finance }"></i>
                        </button> <div x-show="sidebarCollapsed" class="absolute left-full top-0 ml-2 w-48 rounded-lg bg-white shadow-lg border border-gray-100 py-2 hidden group-hover:block">
                            <a href="/finance/customer-accounts/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº”æ”¶è´¦æ¬¾</a>
                            <a href="/finance/supplier-accounts/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº”ä»˜è´¦æ¬¾</a>
                            <a href="/finance/prepayments/customer/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">é¢„æ”¶æ¬¾</a>
                            <a href="/finance/prepayments/supplier/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">é¢„ä»˜æ¬¾</a>
                            <a href="{% url 'finance:account_report' %}" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">å¾€æ¥æŠ¥è¡¨</a>
                            <a href="{% url 'finance:report_list' %}" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">è´¢åŠ¡æŠ¥è¡¨</a>
                        </div> <div x-show="!sidebarCollapsed && menuState.finance" class="mt-1 pl-10 space-y-1"
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 -translate-y-2"
                             x-transition:enter-end="opacity-100 translate-y-0">
                            <a href="/finance/customer-accounts/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº”æ”¶è´¦æ¬¾</a>
                            <a href="/finance/supplier-accounts/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº”ä»˜è´¦æ¬¾</a>
                            <a href="/finance/prepayments/customer/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">é¢„æ”¶æ¬¾</a>
                            <a href="/finance/prepayments/supplier/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">é¢„ä»˜æ¬¾</a>
                            <a href="{% url 'finance:account_report' %}" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">å¾€æ¥æŠ¥è¡¨</a>
                            <a href="{% url 'finance:report_list' %}" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">è´¢åŠ¡æŠ¥è¡¨</a>
                        </div>
                    </div> <!-- Basic Settings -->
                    <div class="relative group">
                        <button @click="toggleMenu('basic_settings')"
                                :aria-expanded="menuState.basic_settings ? 'true' : 'false'"
                                aria-haspopup="true"
                                class="flex items-center h-10 w-full px-3 rounded-lg text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200"
                                :class="{ 'justify-center': sidebarCollapsed, 'w-full': !sidebarCollapsed, 'w-10': sidebarCollapsed }">
                            <i class="fas fa-database text-lg" :class="{ 'mr-0': sidebarCollapsed, 'mr-3': !sidebarCollapsed }"></i>
                            <span class="font-medium flex-grow text-left transition-opacity duration-200"
                                  :class="{ 'opacity-0 w-0': sidebarCollapsed, 'opacity-100': !sidebarCollapsed }">åŸºç¡€è®¾ç½®</span>
                            <i class="fas fa-chevron-down text-sm transition-transform duration-200"
                               :class="{ 'opacity-0 w-0': sidebarCollapsed, 'opacity-100 ml-2': !sidebarCollapsed, 'rotate-180': menuState.basic_settings }"></i>
                        </button> <div x-show="sidebarCollapsed" class="absolute left-full top-0 ml-2 w-56 rounded-lg bg-white shadow-lg border border-gray-100 py-2 hidden group-hover:block">
                            <a href="/products/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">äº§å“ç®¡ç†</a> <a href="/settings/warehouses/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº“ä½è®¾ç½®</a>
                            <a href="/settings/units/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">è®¡é‡å•ä½</a>
                            <a href="/settings/tax-rates/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">ç¨ç‡è®¾ç½®</a>
                            <a href="/settings/print-templates/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">æ‰“å°æ¨¡æ¿</a>
                            <a href="/inventory/import/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">å¯¼å…¥ä¸åˆå§‹åŒ–</a>
                        </div> <div x-show="!sidebarCollapsed && menuState.basic_settings" class="mt-1 pl-10 space-y-1"
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 -translate-y-2"
                             x-transition:enter-end="opacity-100 translate-y-0">
                            <a href="/products/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">äº§å“ç®¡ç†</a> <a href="/settings/warehouses/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">åº“ä½è®¾ç½®</a>
                            <a href="/settings/units/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">è®¡é‡å•ä½</a>
                            <a href="/settings/tax-rates/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">ç¨ç‡è®¾ç½®</a>
                            <a href="/settings/print-templates/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">æ‰“å°æ¨¡æ¿</a>
                            <a href="/inventory/import/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">å¯¼å…¥ä¸åˆå§‹åŒ–</a>
                        </div>
                    </div> <!-- System Management -->
                    <div class="relative group">
                        <button @click="toggleMenu('system')"
                                :aria-expanded="menuState.system ? 'true' : 'false'"
                                aria-haspopup="true"
                                class="flex items-center h-10 w-full px-3 rounded-lg text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200"
                                :class="{ 'justify-center': sidebarCollapsed, 'w-full': !sidebarCollapsed, 'w-10': sidebarCollapsed }">
                            <i class="fas fa-cog text-lg" :class="{ 'mr-0': sidebarCollapsed, 'mr-3': !sidebarCollapsed }"></i>
                            <span class="font-medium flex-grow text-left transition-opacity duration-200"
                                  :class="{ 'opacity-0 w-0': sidebarCollapsed, 'opacity-100': !sidebarCollapsed }">ç³»ç»Ÿç®¡ç†</span>
                            <i class="fas fa-chevron-down text-sm transition-transform duration-200"
                               :class="{ 'opacity-0 w-0': sidebarCollapsed, 'opacity-100 ml-2': !sidebarCollapsed, 'rotate-180': menuState.system }"></i>
                        </button> <div x-show="sidebarCollapsed" class="absolute left-full top-0 ml-2 w-48 rounded-lg bg-white shadow-lg border border-gray-100 py-2 hidden group-hover:block">
                            <a href="/users/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">ç”¨æˆ·ç®¡ç†</a>
                            <a href="/users/roles/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">è§’è‰²æƒé™</a>
                            <a href="/departments/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">éƒ¨é—¨ç®¡ç†</a>
                            <a href="/settings/database/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">æ•°æ®åº“ç®¡ç†</a>
                            <a href="/admin/" class="block px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">ç³»ç»Ÿé…ç½®</a>
                        </div> <div x-show="!sidebarCollapsed && menuState.system" class="mt-1 pl-10 space-y-1"
                             x-transition:enter="transition ease-out duration-200"
                             x-transition:enter-start="opacity-0 -translate-y-2"
                             x-transition:enter-end="opacity-100 translate-y-0">
                            <a href="/users/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">ç”¨æˆ·ç®¡ç†</a>
                            <a href="/users/roles/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">è§’è‰²æƒé™</a>
                            <a href="/departments/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">éƒ¨é—¨ç®¡ç†</a>
                            <a href="/settings/database/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">æ•°æ®åº“ç®¡ç†</a>
                            <a href="/admin/" class="block px-3 py-2 rounded-lg text-sm text-gray-600 hover:bg-gray-50 hover:text-gray-900">ç³»ç»Ÿé…ç½®</a>
                        </div>
                    </div>
                </div>
            </nav>
        </div> <!-- Main Content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Top Header -->
            <header class="bg-white shadow-sm border-b border-gray-200">
                <div class="flex items-center justify-between px-6 py-4">
                    <div class="flex items-center">
                        <button @click="sidebarOpen = !sidebarOpen" class="lg:hidden text-gray-500 hover:text-gray-700">
                            <i class="fas fa-bars w-6 h-6"></i>
                        </button> <!-- Breadcrumb Navigation -->
                        <nav class="ml-4 flex items-center space-x-2 text-sm">
                            <a href="{% url 'dashboard' %}" class="text-gray-500 hover:text-gray-700">
                                <i class="fas fa-home mr-1"></i>é¦–é¡µ
                            </a>
                            {% block breadcrumb %}{% endblock %}
                        </nav>
                    </div> <div class="flex items-center space-x-4">
                        <!-- Notifications -->
                        <div x-data="{ open: false }" class="relative">
                            <button @click="open = !open" class="text-gray-500 hover:text-gray-700 relative">
                                <i class="fas fa-bell w-6 h-6"></i>
                                <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center">3</span>
                            </button>
                            <div x-show="open" @click.away="open = false" x-cloak class="absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50">
                                <div class="p-4 border-b border-gray-200">
                                    <h3 class="text-lg font-semibold">é€šçŸ¥</h3>
                                </div>
                                <div class="max-h-64 overflow-y-auto">
                                    <div class="p-4 border-b border-gray-100 hover:bg-gray-50">
                                        <p class="text-sm text-gray-800">æ–°çš„é”€å”®è®¢å•å¾…å¤„ç†</p>
                                        <p class="text-xs text-gray-500 mt-1">5åˆ†é’Ÿå‰</p>
                                    </div>
                                    <div class="p-4 border-b border-gray-100 hover:bg-gray-50">
                                        <p class="text-sm text-gray-800">åº“å­˜é¢„è­¦ï¼šäº§å“Aåº“å­˜ä¸è¶³</p>
                                        <p class="text-xs text-gray-500 mt-1">1å°æ—¶å‰</p>
                                    </div>
                                    <div class="p-4 hover:bg-gray-50">
                                        <p class="text-sm text-gray-800">é‡‡è´­è®¢å•å·²å®¡æ ¸é€šè¿‡</p>
                                        <p class="text-xs text-gray-500 mt-1">2å°æ—¶å‰</p>
                                    </div>
                                </div>
                            </div>
                        </div> <!-- Theme Switcher -->
                        <div x-data="{ open: false }" class="relative">
                            <button @click="open = !open" class="text-gray-500 hover:text-gray-700 relative" title="åˆ‡æ¢ä¸»é¢˜">
                                <i class="fas fa-palette w-6 h-6"></i>
                            </button>
                            <div x-show="open" @click.away="open = false" x-cloak class="absolute right-0 mt-2 w-40 bg-white rounded-lg shadow-lg border border-gray-200 z-50">
                                <button @click="setTheme('red'); open = false"
                                        class="flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors"
                                        :class="{ 'bg-red-50': theme === 'red' }">
                                    <i class="fas fa-circle text-red-600 mr-2"></i>
                                    <span>çº¢è‰²ä¸»é¢˜</span>
                                    <i x-show="theme === 'red'" class="fas fa-check ml-auto text-red-600"></i>
                                </button>
                                <button @click="setTheme('yellow'); open = false"
                                        class="flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors"
                                        :class="{ 'bg-yellow-50': theme === 'yellow' }">
                                    <i class="fas fa-circle mr-2" style="color: #d88c27;"></i>
                                    <span>é»„è‰²ä¸»é¢˜</span>
                                    <i x-show="theme === 'yellow'" class="fas fa-check ml-auto" style="color: #d88c27;"></i>
                                </button>
                                <button @click="setTheme('blue'); open = false"
                                        class="flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors"
                                        :class="{ 'bg-theme-50': theme === 'blue' }">
                                    <i class="fas fa-circle text-theme-600 mr-2"></i>
                                    <span>è“è‰²ä¸»é¢˜</span>
                                    <i x-show="theme === 'blue'" class="fas fa-check ml-auto text-theme-600"></i>
                                </button>
                            </div>
                        </div> <!-- User Menu -->
                        <div x-data="{ open: false }" class="relative">
                            <button @click="open = !open" class="flex items-center space-x-2 text-gray-700 hover:text-gray-900">
                                <img :src="'https://ui-avatars.com/api/?name={{ user.username|urlencode }}&background=' + (theme === 'yellow' ? 'd88c27' : theme === 'red' ? 'ef4444' : '3b82f6') + '&color=fff'" alt="Avatar" class="w-8 h-8 rounded-full">
                                <span class="hidden md:block">{{ user.username }}</span>
                                <i class="fas fa-chevron-down w-4 h-4"></i>
                            </button>
                            <div x-show="open" @click.away="open = false" x-cloak class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-50">
                                <a href="/admin/" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">ç³»ç»Ÿåå°</a>
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">ä¸ªäººèµ„æ–™</a>
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">è®¾ç½®</a>
                                <hr class="my-1">
                                <a href="{% url 'logout' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">é€€å‡ºç™»å½•</a>
                            </div>
                        </div>
                    </div>
                </div>
            </header> <!-- Page Content -->
            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-50">
                <div class="container mx-auto px-6 py-8">
                    {% if messages %}
                    <div class="mb-6 space-y-2">
                        {% for message in messages %}
                        <div class="p-4 rounded-lg flex items-center justify-between shadow-sm {% if message.tags == 'error' %}bg-red-50 text-red-700 border border-red-200{% elif message.tags == 'success' %}bg-green-50 text-green-700 border border-green-200{% elif message.tags == 'warning' %}bg-yellow-50 text-yellow-700 border border-yellow-200{% else %}bg-theme-50 text-theme-700 border border-theme-200{% endif %}">
                            <div class="flex items-center">
                                {% if message.tags == 'error' %}
                                <i class="fas fa-times-circle mr-3 text-lg"></i>
                                {% elif message.tags == 'success' %}
                                <i class="fas fa-check-circle mr-3 text-lg"></i>
                                {% elif message.tags == 'warning' %}
                                <i class="fas fa-exclamation-triangle mr-3 text-lg"></i>
                                {% else %}
                                <i class="fas fa-info-circle mr-3 text-lg"></i>
                                {% endif %}
                                <span class="font-medium">{{ message }}</span>
                            </div>
                            <button onclick="this.parentElement.remove()" class="text-gray-400 hover:text-gray-600 transition-colors">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        {% endfor %}
                    </div>
                    {% endif %} {% block content %}{% endblock %}
                </div>
            </main>
        </div>
    </div> <!-- Mobile Sidebar Overlay -->
    <div x-show="sidebarOpen" @click="sidebarOpen = false" x-cloak class="fixed inset-0 z-40 bg-black bg-opacity-50 lg:hidden"></div> <!-- Tom Select å…¨å±€åˆå§‹åŒ–è„šæœ¬ -->
    <script>
        // å…¨å±€åˆå§‹åŒ–æ‰€æœ‰ select å…ƒç´ ä¸º Tom Select
        document.addEventListener('DOMContentLoaded', function() {
            // å»¶è¿Ÿåˆå§‹åŒ–ç¡®ä¿ DOM å®Œå…¨åŠ è½½
            setTimeout(function() {
                // æ‰¾åˆ°æ‰€æœ‰è¿˜æ²¡æœ‰è¢«åˆå§‹åŒ–çš„ select å…ƒç´ 
                const selectElements = document.querySelectorAll('select:not(.tomselected)');
                selectElements.forEach(function(select) {
                // è·³è¿‡å·²ç»è¢«åˆå§‹åŒ–çš„å…ƒç´ 
                if (select.tomselect) return;

                // åˆ¤æ–­æ˜¯å¦ä¸ºå•é€‰æ¨¡å¼
                const isSingleSelect = !select.multiple;

                const instance = new TomSelect(select, {
                    plugins: [],
                    allowEmptyOption: true,
                    create: false,
                    maxOptions: null,
                    openOnFocus: true,
                    selectOnTab: true,
                    hideSelected: false, // ç¡®ä¿å·²é€‰é¡¹å¯è§
                    placeholder: 'è¯·é€‰æ‹©',
                    render: {
                        option: function(data, escape) {
                            return '<div>' + escape(data.text) + '</div>';
                        },
                        item: function(data, escape) {
                            return '<div>' + escape(data.text) + '</div>';
                        },
                        no_results: function(data, escape) {
                            return '<div class="no-results" style="padding: 8px 12px; color: #9ca3af;">æœªæ‰¾åˆ°åŒ¹é…é¡¹</div>';
                        }
                    },
                    onType: function(str) {
                        // ç”¨æˆ·è¾“å…¥æ—¶è‡ªåŠ¨æ‰“å¼€ä¸‹æ‹‰åˆ—è¡¨æ˜¾ç¤ºåŒ¹é…é¡¹
                        if (!this.isOpen) {
                            this.open();
                        }
                    },
                    onChange: function(value) {
                        // å•é€‰æ¨¡å¼ï¼šé€‰æ‹©åå…³é—­ä¸‹æ‹‰åˆ—è¡¨å¹¶ç«‹å³å¤±å»ç„¦ç‚¹
                        if (isSingleSelect) {
                            this.close();

                            // ç«‹å³å¤±å»ç„¦ç‚¹ï¼Œè§¦å‘æ˜¾ç¤ºé€‰ä¸­é¡¹
                            requestAnimationFrame(() => {
                                this.blur();

                                // å¼ºåˆ¶åˆ·æ–°æ˜¾ç¤ºï¼ˆè§£å†³äºŒæ¬¡é€‰æ‹©åŒä¸€é€‰é¡¹ä¸æ˜¾ç¤ºçš„é—®é¢˜ï¼‰
                                // æ‰‹åŠ¨æ›´æ–° DOM æ¥ç¡®ä¿æ˜¾ç¤º
                                const control = this.wrapper.querySelector('.ts-control');
                                if (control) {
                                    // ç§»é™¤è¾“å…¥æ¿€æ´»çŠ¶æ€ï¼Œæ˜¾ç¤º item
                                    control.classList.remove('input-active');

                                    // å¼ºåˆ¶é‡æ–°æ¸²æŸ“
                                    const item = control.querySelector('.item');
                                    if (item) {
                                        item.style.display = '';
                                    }
                                }
                            });
                        }
                    },
                    onDropdownOpen: function() {
                        // ä¸‹æ‹‰æ‰“å¼€æ—¶ï¼Œç¡®ä¿è¾“å…¥æ¡†å¯ç”¨ï¼ˆå•é€‰æ¨¡å¼ï¼‰
                        if (isSingleSelect) {
                            const control = this.wrapper.querySelector('.ts-control');
                            if (control) {
                                control.classList.add('input-active');
                            }
                        }
                    },
                    onDropdownClose: function() {
                        // ä¸‹æ‹‰å…³é—­æ—¶ï¼Œç§»é™¤è¾“å…¥æ¿€æ´»çŠ¶æ€ï¼ˆå•é€‰æ¨¡å¼ï¼‰
                        if (isSingleSelect) {
                            const control = this.wrapper.querySelector('.ts-control');
                            if (control) {
                                control.classList.remove('input-active');
                            }
                        }
                    }
                });
            });
            }, 100); // å»¶è¿Ÿ100msç¡®ä¿Alpine.jså®Œæˆæ¸²æŸ“
        }); // æ—¥æœŸé€‰æ‹©å™¨å¢å¼º - ç¡®ä¿æ‰€æœ‰æ—¥æœŸè¾“å…¥æ¡†ç‚¹å‡»æ—¶ç›´æ¥å¼¹å‡ºæ—¥æœŸé€‰æ‹©å™¨
        document.addEventListener('DOMContentLoaded', function() {
            const dateInputs = document.querySelectorAll('input[type="date"]'); dateInputs.forEach(function(input) {
                // ç‚¹å‡»æ—¶è§¦å‘æ—¥æœŸé€‰æ‹©å™¨
                input.addEventListener('click', function(e) {
                    // ä½¿ç”¨HTML5çš„showPicker() APIï¼ˆç°ä»£æµè§ˆå™¨æ”¯æŒï¼‰
                    if (typeof this.showPicker === 'function') {
                        this.showPicker();
                    }
                }); // èšç„¦æ—¶ä¹Ÿè§¦å‘æ—¥æœŸé€‰æ‹©å™¨
                input.addEventListener('focus', function(e) {
                    if (typeof this.showPicker === 'function') {
                        // å»¶è¿Ÿè§¦å‘ä»¥ç¡®ä¿UIæ­£å¸¸æ¸²æŸ“
                        setTimeout(() => {
                            this.showPicker();
                        }, 10);
                    }
                });
            });
        });
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>