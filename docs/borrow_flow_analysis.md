# é‡‡è´­å€Ÿç”¨åŠŸèƒ½æµç¨‹æ¢³ç†

**ç‰ˆæœ¬**: v1.0
**æ—¥æœŸ**: 2026-01-06
**æ•´ç†äºº**: æµ®æµ®é…± (å¹½æµ®å–µ)
**åŸºäº**: å®é™…å·²å®ç°ä»£ç 

---

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

### ä¸šåŠ¡å®šä½
é‡‡è´­å€Ÿç”¨æ˜¯ä¸€ä¸ª**ä¸´æ—¶æ€§ç‰©æ–™è·å–æ¸ é“**ï¼Œç”¨äºæ»¡è¶³çŸ­æœŸéœ€æ±‚ï¼Œä¸è®¡å…¥æ­£å¼é‡‡è´­æµç¨‹ã€‚

### æ ¸å¿ƒç‰¹ç‚¹
1. âœ… **ä»…åšç³»ç»Ÿè®°å½•** - ä¸ç”Ÿæˆåº“å­˜äº‹åŠ¡ï¼Œä¸äº§ç”Ÿåº”ä»˜è´¦æ¬¾
2. âœ… **æ— éœ€å€Ÿç”¨å®¡æ ¸** - åˆ›å»ºåç›´æ¥è¿›å…¥"å€Ÿç”¨ä¸­"çŠ¶æ€
3. âœ… **æ”¯æŒéƒ¨åˆ†å½’è¿˜** - å¯å¤šæ¬¡å½’è¿˜ï¼Œçµæ´»å¤„ç†
4. âœ… **è½¬é‡‡è´­å®¡æ ¸** - å†³å®šè´­ä¹°æ—¶éœ€å®¡æ ¸ï¼Œå®¡æ ¸åç”Ÿæˆæ­£å¼é‡‡è´­è®¢å•
5. âœ… **æ‰‹åŠ¨å®šä»·** - è½¬é‡‡è´­æ—¶éœ€æ‰‹åŠ¨è¾“å…¥ä»·æ ¼

---

## ğŸ”„ å®Œæ•´ä¸šåŠ¡æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ã€é‡‡è´­å€Ÿç”¨å®Œæ•´æµç¨‹ã€‘                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   åˆ›å»ºå€Ÿç”¨å•   â”‚
                    â”‚  (draftè‰ç¨¿)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ å¡«å†™åŸºæœ¬ä¿¡æ¯ï¼š
                            â”‚ - é€‰æ‹©ä¾›åº”å•†
                            â”‚ - æ·»åŠ å€Ÿç”¨äº§å“æ˜ç»†
                            â”‚ - è®¾ç½®å€Ÿç”¨æ—¥æœŸ
                            â”‚ - å¡«å†™å€Ÿç”¨ç›®çš„
                            â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   æäº¤å€Ÿç”¨å•   â”‚ â—„â”€â”€ æ— éœ€å®¡æ ¸ï¼Œç›´æ¥è¿›å…¥å€Ÿç”¨ä¸­
                    â”‚  (borrowed)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                           â”‚
              â”‚ã€å€Ÿç”¨ä¸­ï¼Œæœ‰ä¸¤ç§å¤„ç†æ–¹å¼ã€‘ â”‚
              â”‚                           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                   â”‚       â”‚                  â”‚
    â”‚   1ï¸âƒ£ å½’è¿˜æµç¨‹    â”‚       â”‚  2ï¸âƒ£ è½¬é‡‡è´­æµç¨‹  â”‚
    â”‚                   â”‚       â”‚                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                           â”‚
              â”‚                           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  å¤„ç†å½’è¿˜          â”‚       â”‚  å‘èµ·è½¬é‡‡è´­è¯·æ±‚      â”‚
    â”‚  (éƒ¨åˆ†æˆ–å…¨éƒ¨)      â”‚       â”‚  (æ‰‹åŠ¨è¾“å…¥ä»·æ ¼)      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                           â”‚
              â”‚                           â”‚ æ›´æ–°çŠ¶æ€
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ éƒ¨åˆ†å½’è¿˜ï¼Ÿ         â”‚       â”‚   è½¬æ¢ä¸­(converting) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   ç­‰å¾…å®¡æ ¸           â”‚
              â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                    â”‚
         â”‚         â”‚                    â”‚
    YES  â”‚         â”‚ NO                 â”‚ ç®¡ç†å‘˜å®¡æ ¸
         â”‚         â”‚                    â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚éƒ¨åˆ†å½’è¿˜â”‚ â”‚å…¨éƒ¨å½’è¿˜  â”‚       â”‚ å®¡æ ¸é€šè¿‡ + ç”Ÿæˆï¼š   â”‚
    â”‚        â”‚ â”‚          â”‚       â”‚ - é‡‡è´­è®¢å•          â”‚
    â”‚å¯ç»§ç»­  â”‚ â”‚          â”‚       â”‚ - é‡‡è´­å…¥åº“å•        â”‚
    â”‚å€Ÿç”¨æˆ–  â”‚ â”‚æµç¨‹ç»“æŸ  â”‚       â”‚ - åº”ä»˜è´¦æ¬¾          â”‚
    â”‚è½¬é‡‡è´­  â”‚ â”‚          â”‚       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
         â”‚                               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  å·²è½¬é‡‡è´­     â”‚
                              â”‚  (converted)  â”‚
                              â”‚  æµç¨‹ç»“æŸ     â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š çŠ¶æ€æµè½¬è¯¦è§£

### çŠ¶æ€å®šä¹‰

| çŠ¶æ€ä»£ç  | çŠ¶æ€åç§° | è¯´æ˜ | å¯æ‰§è¡Œæ“ä½œ |
|---------|---------|------|-----------|
| `draft` | è‰ç¨¿ | åˆå§‹åˆ›å»ºçŠ¶æ€ | ç¼–è¾‘ã€æäº¤ã€åˆ é™¤ |
| `borrowed` | å€Ÿç”¨ä¸­ | å·²ä»ä¾›åº”å•†å€Ÿå…¥ï¼ˆç³»ç»Ÿè®°å½•ï¼‰ | å½’è¿˜ã€è½¬é‡‡è´­ |
| `partially_returned` | éƒ¨åˆ†å½’è¿˜ | å·²å½’è¿˜éƒ¨åˆ†ç‰©æ–™ | ç»§ç»­å½’è¿˜ã€è½¬é‡‡è´­ |
| `fully_returned` | å…¨éƒ¨å½’è¿˜ | å·²å…¨éƒ¨å½’è¿˜ | æ— ï¼ˆæµç¨‹ç»“æŸï¼‰|
| `converting` | è½¬æ¢ä¸­ | ç­‰å¾…è½¬é‡‡è´­å®¡æ ¸ | å®¡æ ¸é€šè¿‡/æ‹’ç» |
| `converted` | å·²è½¬é‡‡è´­ | å·²è½¬ä¸ºæ­£å¼é‡‡è´­è®¢å• | æ— ï¼ˆæµç¨‹ç»“æŸï¼‰|
| `cancelled` | å·²å–æ¶ˆ | å€Ÿç”¨å•å·²å–æ¶ˆ | æ— ï¼ˆæµç¨‹ç»“æŸï¼‰|

### çŠ¶æ€æµè½¬è§„åˆ™

```
draft â†’ borrowed â†’ â”¬â†’ partially_returned â†’ â”¬â†’ fully_returned (ç»“æŸ)
                   â”‚                       â””â†’ converting â†’ converted (ç»“æŸ)
                   â””â†’ converting â†’ converted (ç»“æŸ)

ä»»ä½•çŠ¶æ€ â†’ cancelled (å–æ¶ˆ)
```

---

## ğŸ¯ æ ¸å¿ƒä¸šåŠ¡åœºæ™¯è¯¦è§£

### åœºæ™¯1ï¸âƒ£: åˆ›å»ºå€Ÿç”¨å•

**ç”¨æˆ·æ“ä½œ**ï¼š
1. è®¿é—® `/purchase/borrows/create/`
2. å¡«å†™å€Ÿç”¨ä¿¡æ¯ï¼š
   - **ä¾›åº”å•†**ï¼šä»ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©ï¼ˆå¿…å¡«ï¼‰
   - **å€Ÿç”¨æ—¥æœŸ**ï¼šé€‰æ‹©å€Ÿç”¨æ—¥æœŸï¼ˆå¿…å¡«ï¼‰
   - **é¢„è®¡å½’è¿˜æ—¥æœŸ**ï¼šå¯é€‰
   - **å€Ÿç”¨ç›®çš„**ï¼šå¡«å†™å€Ÿç”¨åŸå› 
   - **äº§å“æ˜ç»†**ï¼šæ·»åŠ å¤šä¸ªäº§å“ï¼Œå¡«å†™æ•°é‡

**ç³»ç»Ÿå¤„ç†**ï¼š
```python
# 1. ç”Ÿæˆå€Ÿç”¨å•å·
loan_number = DocumentNumberGenerator.generate('borrow')
# æ ¼å¼ï¼šBO + YYMMDD + åºå· (ä¾‹å¦‚ï¼šBO260106001)

# 2. åˆ›å»ºå€Ÿç”¨å•
borrow = Borrow.objects.create(
    borrow_number=loan_number,
    supplier=supplier,
    buyer=current_user,
    borrow_date=borrow_date,
    status='borrowed',  # ç›´æ¥è¿›å…¥å€Ÿç”¨ä¸­ï¼Œæ— éœ€å®¡æ ¸ï¼
    created_by=current_user
)

# 3. åˆ›å»ºå€Ÿç”¨æ˜ç»†
for item_data in items:
    BorrowItem.objects.create(
        borrow=borrow,
        product=product,
        quantity=quantity,
        batch_number=batch_number
    )
```

**å…³é”®è§„åˆ™**ï¼š
- âœ… æ— éœ€å®¡æ ¸ï¼Œåˆ›å»ºå³ç”Ÿæ•ˆï¼ˆ`status='borrowed'`ï¼‰
- âœ… **ä¸ç”Ÿæˆåº“å­˜äº‹åŠ¡**ï¼ˆä»…ç³»ç»Ÿè®°å½•ï¼‰
- âœ… **ä¸ç”Ÿæˆåº”ä»˜è´¦æ¬¾**ï¼ˆæœªæ­£å¼é‡‡è´­ï¼‰
- âœ… è‡ªåŠ¨ç”Ÿæˆå”¯ä¸€å•æ®å·ï¼ˆBOå‰ç¼€ï¼‰

---

### åœºæ™¯2ï¸âƒ£: å½’è¿˜å¤„ç†

**ç”¨æˆ·æ“ä½œ**ï¼š
1. è®¿é—®å€Ÿç”¨å•è¯¦æƒ…é¡µ
2. ç‚¹å‡»"å¤„ç†å½’è¿˜"æŒ‰é’®
3. è®¿é—® `/purchase/borrows/{id}/return/`
4. ä¸ºæ¯ä¸ªäº§å“è¾“å…¥å½’è¿˜æ•°é‡
   - å¯ä»¥è¾“å…¥éƒ¨åˆ†æ•°é‡
   - å¯ä»¥ç‚¹å‡»"å…¨éƒ¨å½’è¿˜"å¿«æ·æŒ‰é’®
5. æäº¤å½’è¿˜

**ç³»ç»Ÿå¤„ç†**ï¼š
```python
# 1. éªŒè¯çŠ¶æ€
if borrow.status not in ['borrowed', 'partially_returned']:
    raise Error('å½“å‰çŠ¶æ€ä¸å…è®¸å½’è¿˜')

# 2. å¤„ç†æ¯ä¸ªæ˜ç»†çš„å½’è¿˜æ•°é‡
for item in items:
    return_qty = request.POST.get(f'return_qty_{item.pk}')

    # éªŒè¯å½’è¿˜æ•°é‡
    if return_qty > item.remaining_quantity:
        raise Error('å½’è¿˜æ•°é‡ä¸èƒ½è¶…è¿‡å‰©ä½™æ•°é‡')

    # ç´¯åŠ å½’è¿˜æ•°é‡
    item.returned_quantity += return_qty
    item.save()

# 3. æ›´æ–°å€Ÿç”¨å•çŠ¶æ€
if borrow.is_fully_returned:  # å‰©ä½™æ•°é‡ä¸º0
    borrow.status = 'fully_returned'
else:
    borrow.status = 'partially_returned'
borrow.save()
```

**æ•°é‡è®¡ç®—é€»è¾‘**ï¼š
```python
# BorrowItem çš„å‰©ä½™æ•°é‡è®¡ç®—
@property
def remaining_quantity(self):
    """å‰©ä½™æ•°é‡ = å€Ÿç”¨æ•°é‡ - å·²å½’è¿˜æ•°é‡ - å·²è½¬é‡‡è´­æ•°é‡"""
    return self.quantity - self.returned_quantity - self.conversion_quantity

# ç¤ºä¾‹ï¼š
# å€Ÿç”¨æ•°é‡ï¼š10
# å·²å½’è¿˜ï¼š3
# å·²è½¬é‡‡è´­ï¼š2
# å‰©ä½™æ•°é‡ï¼š10 - 3 - 2 = 5
```

**å…³é”®è§„åˆ™**ï¼š
- âœ… æ”¯æŒ**å¤šæ¬¡éƒ¨åˆ†å½’è¿˜**ï¼ˆçµæ´»å¤„ç†ï¼‰
- âœ… å½’è¿˜æ•°é‡ç´¯åŠ ï¼Œä¸æ˜¯è¦†ç›–
- âœ… å‰©ä½™æ•°é‡è‡ªåŠ¨è®¡ç®—
- âœ… **ä¸ç”Ÿæˆåº“å­˜äº‹åŠ¡**ï¼ˆæœªå…¥åº“ï¼Œæ— éœ€å‡ºåº“ï¼‰

---

### åœºæ™¯3ï¸âƒ£: è½¬é‡‡è´­è®¢å•æµç¨‹

#### 3.1 å‘èµ·è½¬é‡‡è´­è¯·æ±‚

**ç”¨æˆ·æ“ä½œ**ï¼š
1. è®¿é—®å€Ÿç”¨å•è¯¦æƒ…é¡µ
2. ç‚¹å‡»"è½¬é‡‡è´­è®¢å•"æŒ‰é’®
3. è®¿é—® `/purchase/borrows/{id}/request-conversion/`
4. ä¸ºæ¯ä¸ªäº§å“å¡«å†™ï¼š
   - **è½¬é‡‡è´­æ•°é‡**ï¼šä¸èƒ½è¶…è¿‡å‰©ä½™æ•°é‡
   - **å«ç¨å•ä»·**ï¼šæ‰‹åŠ¨è¾“å…¥ä»·æ ¼ï¼ˆå¿…å¡«ï¼‰
   - å¯ä»¥åªè½¬éƒ¨åˆ†äº§å“
   - å¯ä»¥ç‚¹å‡»"å…¨éƒ¨è½¬æ¢"å¿«æ·æŒ‰é’®
5. å¡«å†™è½¬é‡‡è´­å¤‡æ³¨
6. æäº¤å®¡æ ¸

**ç³»ç»Ÿå¤„ç†**ï¼š
```python
# 1. éªŒè¯çŠ¶æ€
if borrow.status not in ['borrowed', 'partially_returned']:
    raise Error('å½“å‰çŠ¶æ€ä¸å…è®¸è½¬é‡‡è´­')

# 2. éªŒè¯å’Œä¿å­˜è½¬æ¢æ•°æ®
for item in items:
    convert_qty = request.POST.get(f'convert_qty_{item.pk}')
    unit_price = request.POST.get(f'unit_price_{item.pk}')

    # éªŒè¯
    if convert_qty > item.remaining_quantity:
        raise Error('è½¬æ¢æ•°é‡ä¸èƒ½è¶…è¿‡å‰©ä½™æ•°é‡')
    if unit_price <= 0:
        raise Error('å•ä»·å¿…é¡»å¤§äº0')

    # ä¿å­˜åˆ°æ˜ç»†ï¼ˆæš‚å­˜ï¼‰
    item.conversion_quantity = convert_qty
    item.conversion_unit_price = unit_price
    item.save()

# 3. æ›´æ–°çŠ¶æ€ä¸ºå¾…å®¡æ ¸
borrow.status = 'converting'
borrow.conversion_notes = notes
borrow.save()
```

**ç•Œé¢ç‰¹ç‚¹**ï¼š
- ğŸ“Š **å®æ—¶å°è®¡è®¡ç®—**ï¼šæ•°é‡ Ã— å•ä»· = å°è®¡ï¼ˆJavaScriptï¼‰
- ğŸ“Š **æ€»è®¡è®¡ç®—**ï¼šæ‰€æœ‰å°è®¡ä¹‹å’Œ
- âš ï¸ **å¿…å¡«éªŒè¯**ï¼šè‡³å°‘è½¬æ¢ä¸€ä¸ªäº§å“ï¼Œä¸”å¿…é¡»å¡«å†™ä»·æ ¼
- ğŸ¯ **å¿«æ·æ“ä½œ**ï¼šå…¨éƒ¨è½¬æ¢æŒ‰é’®

**å…³é”®è§„åˆ™**ï¼š
- âœ… **æ‰‹åŠ¨è¾“å…¥ä»·æ ¼**ï¼ˆä¸ä»äº§å“ä¸»æ•°æ®è¯»å–ï¼‰
- âœ… æ”¯æŒ**éƒ¨åˆ†è½¬æ¢**ï¼ˆå‰©ä½™å¯ç»§ç»­å€Ÿç”¨æˆ–å½’è¿˜ï¼‰
- âœ… è½¬æ¢æ•°æ®æš‚å­˜ï¼Œç­‰å¾…å®¡æ ¸
- âœ… æäº¤åä¸èƒ½ä¿®æ”¹ï¼ˆåªèƒ½å®¡æ ¸é€šè¿‡/æ‹’ç»ï¼‰

#### 3.2 å®¡æ ¸è½¬é‡‡è´­

**ç”¨æˆ·æ“ä½œ**ï¼š
1. ç®¡ç†å‘˜è®¿é—®å€Ÿç”¨å•è¯¦æƒ…é¡µ
2. çœ‹åˆ°"å®¡æ ¸é€šè¿‡"æŒ‰é’®ï¼ˆä»…ç®¡ç†å‘˜å¯è§ï¼‰
3. ç‚¹å‡»"å®¡æ ¸é€šè¿‡"
4. ç¡®è®¤åæäº¤

**ç³»ç»Ÿå¤„ç†**ï¼š
```python
# 1. æƒé™éªŒè¯
if not request.user.is_staff:
    raise Error('æ‚¨æ²¡æœ‰å®¡æ ¸æƒé™')

# 2. çŠ¶æ€éªŒè¯
if borrow.status != 'converting':
    raise Error('åªæœ‰è½¬æ¢ä¸­çŠ¶æ€æ‰èƒ½å®¡æ ¸')

# 3. å¹‚ç­‰æ€§æ£€æŸ¥
if borrow.converted_order:
    return borrow.converted_order  # å·²è½¬æ¢è¿‡ï¼Œç›´æ¥è¿”å›

# 4. ç”Ÿæˆé‡‡è´­è®¢å•
order = PurchaseOrder.objects.create(
    order_number=DocumentNumberGenerator.generate('purchase_order'),
    supplier=borrow.supplier,
    buyer=borrow.buyer,
    order_date=today,
    status='pending',  # éœ€è¦å†æ¬¡å®¡æ ¸
    notes=f'ç”±å€Ÿç”¨å• {borrow.borrow_number} è½¬æ¢è€Œæ¥'
)

# 5. åˆ›å»ºè®¢å•æ˜ç»†ï¼ˆåªè½¬æ¢æœ‰conversion_quantityçš„æ˜ç»†ï¼‰
for item in borrow.items.filter(conversion_quantity__gt=0):
    PurchaseOrderItem.objects.create(
        purchase_order=order,
        product=item.product,
        quantity=item.conversion_quantity,
        unit_price=item.conversion_unit_price,
        notes=f'æ¥è‡ªå€Ÿç”¨å•æ˜ç»† (æ‰¹æ¬¡: {item.batch_number})'
    )

# 6. æ›´æ–°å€Ÿç”¨å•çŠ¶æ€
borrow.status = 'converted'
borrow.converted_order = order
borrow.conversion_approved_by = current_user
borrow.conversion_approved_at = now()
borrow.save()
```

**å®¡æ ¸åç”Ÿæˆ**ï¼š
1. âœ… **é‡‡è´­è®¢å•**ï¼ˆPurchaseOrderï¼‰- çŠ¶æ€ä¸º `pending`
2. â³ é‡‡è´­è®¢å•å®¡æ ¸å â†’ ç”Ÿæˆå…¥åº“å•
3. â³ é‡‡è´­è®¢å•å®¡æ ¸å â†’ ç”Ÿæˆåº”ä»˜è´¦æ¬¾

**å…³é”®è§„åˆ™**ï¼š
- âœ… **ä»…ç®¡ç†å‘˜å¯å®¡æ ¸**ï¼ˆ`is_staff=True`ï¼‰
- âœ… **å¹‚ç­‰æ€§ä¿æŠ¤**ï¼ˆé˜²æ­¢é‡å¤å®¡æ ¸ï¼‰
- âœ… ç”Ÿæˆçš„é‡‡è´­è®¢å•éœ€è¦**å†æ¬¡å®¡æ ¸**
- âœ… å®¡æ ¸å**ä¸å¯æ’¤é”€**ï¼ˆå•å‘æµç¨‹ï¼‰

---

## ğŸ’¾ æ•°æ®æ¨¡å‹è¯¦è§£

### Borrowï¼ˆå€Ÿç”¨å•ä¸»è¡¨ï¼‰

```python
# æ ¸å¿ƒå­—æ®µ
borrow_number       # å€Ÿç”¨å•å·ï¼ˆå”¯ä¸€ï¼‰- BO260106001
supplier            # ä¾›åº”å•†ï¼ˆå¤–é”®ï¼‰
buyer               # ç»åŠäººï¼ˆé‡‡è´­å‘˜ï¼‰
status              # çŠ¶æ€ï¼ˆ7ç§ï¼‰
borrow_date         # å€Ÿç”¨æ—¥æœŸ
expected_return_date # é¢„è®¡å½’è¿˜æ—¥æœŸï¼ˆå¯é€‰ï¼‰

# è½¬é‡‡è´­ç›¸å…³
converted_order             # è½¬æ¢çš„é‡‡è´­è®¢å•ï¼ˆå¤–é”®ï¼‰
conversion_approved_by      # å®¡æ ¸äºº
conversion_approved_at      # å®¡æ ¸æ—¶é—´
conversion_notes            # è½¬é‡‡è´­å¤‡æ³¨

# è®¡ç®—å±æ€§ï¼ˆ@propertyï¼‰
total_borrowed_quantity     # æ€»å€Ÿç”¨æ•°é‡
total_returned_quantity     # æ€»å½’è¿˜æ•°é‡
total_remaining_quantity    # æ€»å‰©ä½™æ•°é‡
is_fully_returned           # æ˜¯å¦å…¨éƒ¨å½’è¿˜
```

### BorrowItemï¼ˆå€Ÿç”¨æ˜ç»†ï¼‰

```python
# æ ¸å¿ƒå­—æ®µ
borrow              # å€Ÿç”¨å•ï¼ˆå¤–é”®ï¼‰
product             # äº§å“ï¼ˆå¤–é”®ï¼‰
quantity            # å€Ÿç”¨æ•°é‡ï¼ˆDecimalFieldï¼Œ4ä½å°æ•°ï¼‰

# å½’è¿˜è¿½è¸ª
returned_quantity   # å·²å½’è¿˜æ•°é‡ï¼ˆç´¯åŠ ï¼‰

# è½¬é‡‡è´­æ•°æ®ï¼ˆæš‚å­˜ï¼‰
conversion_quantity     # è½¬é‡‡è´­æ•°é‡
conversion_unit_price   # è½¬é‡‡è´­å•ä»·ï¼ˆDecimalFieldï¼Œ2ä½å°æ•°ï¼‰

# ç‰©æ–™è¿½è¸ª
batch_number        # æ‰¹æ¬¡å·
serial_numbers      # åºåˆ—å·ï¼ˆå¤šä¸ªç”¨æ¢è¡Œåˆ†éš”ï¼‰

# è®¡ç®—å±æ€§ï¼ˆ@propertyï¼‰
remaining_quantity  # å‰©ä½™æ•°é‡ = å€Ÿç”¨ - å½’è¿˜ - è½¬é‡‡è´­
can_convert         # æ˜¯å¦å¯è½¬é‡‡è´­ = remaining_quantity > 0
```

---

## ğŸ” æƒé™æ§åˆ¶

### æ“ä½œæƒé™çŸ©é˜µ

| æ“ä½œ | æ™®é€šç”¨æˆ· | ç®¡ç†å‘˜ | çŠ¶æ€è¦æ±‚ |
|-----|---------|--------|---------|
| åˆ›å»ºå€Ÿç”¨å• | âœ… | âœ… | - |
| æŸ¥çœ‹è¯¦æƒ… | âœ… | âœ… | - |
| ç¼–è¾‘å€Ÿç”¨å• | âœ… | âœ… | `draft` |
| å¤„ç†å½’è¿˜ | âœ… | âœ… | `borrowed` æˆ– `partially_returned` |
| å‘èµ·è½¬é‡‡è´­ | âœ… | âœ… | `borrowed` æˆ– `partially_returned` |
| å®¡æ ¸è½¬é‡‡è´­ | âŒ | âœ… | `converting` |
| åˆ é™¤å€Ÿç”¨å• | âœ… | âœ… | `draft` |

### è§†å›¾å±‚æƒé™ä»£ç 

```python
# borrow_detail.py - è®¡ç®—æ“ä½œæƒé™
can_edit = (borrow.status == 'draft')
can_return = (borrow.status in ['borrowed', 'partially_returned'])
can_request_conversion = (
    borrow.status in ['borrowed', 'partially_returned'] and
    borrow.total_remaining_quantity > 0
)
can_approve_conversion = (
    request.user.is_staff and  # ä»…ç®¡ç†å‘˜
    borrow.status == 'converting'
)
```

---

## ğŸ“± ç”¨æˆ·ç•Œé¢è®¾è®¡

### åˆ—è¡¨é¡µ (`borrow_list.html`)

**ç»Ÿè®¡å¡ç‰‡**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å€Ÿç”¨ä¸­      â”‚ éƒ¨åˆ†å½’è¿˜     â”‚ å¾…å®¡æ ¸       â”‚ å·²è½¬é‡‡è´­     â”‚
â”‚    15       â”‚     8        â”‚     3        â”‚    12        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç­›é€‰æ¡ä»¶**ï¼š
- çŠ¶æ€ç­›é€‰ï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼‰
- ä¾›åº”å•†ç­›é€‰ï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼‰
- æ—¥æœŸèŒƒå›´ï¼ˆå¼€å§‹æ—¥æœŸ ~ ç»“æŸæ—¥æœŸï¼‰

**æ•°æ®è¡¨æ ¼**ï¼š
| å€Ÿç”¨å•å· | ä¾›åº”å•† | ç»åŠäºº | å€Ÿç”¨æ—¥æœŸ | é¢„è®¡å½’è¿˜ | çŠ¶æ€ | æ“ä½œ |
|---------|-------|-------|---------|---------|-----|------|

### è¯¦æƒ…é¡µ (`borrow_detail.html`)

**çŠ¶æ€å¾½ç« **ï¼š
```
å½“å‰çŠ¶æ€: [å€Ÿç”¨ä¸­] [éƒ¨åˆ†å½’è¿˜] [è½¬æ¢ä¸­] ç­‰
```

**åŸºæœ¬ä¿¡æ¯å¡ç‰‡**ï¼š
- ä¾›åº”å•†ã€å€Ÿç”¨æ—¥æœŸã€é¢„è®¡å½’è¿˜æ—¥æœŸ
- ç»åŠäººã€åˆ›å»ºæ—¶é—´ã€åˆ›å»ºäºº
- å€Ÿç”¨ç›®çš„ã€å¤‡æ³¨

**æ•°é‡ç»Ÿè®¡å¡ç‰‡**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ€»å€Ÿç”¨æ•°é‡       â”‚ å·²å½’è¿˜æ•°é‡       â”‚ å‰©ä½™æ•°é‡         â”‚
â”‚    100          â”‚     30          â”‚     70          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ˜ç»†è¡¨æ ¼**ï¼š
| äº§å“ | å€Ÿç”¨æ•°é‡ | å·²å½’è¿˜ | å·²è½¬é‡‡è´­ | å‰©ä½™æ•°é‡ | æ‰¹æ¬¡å· | è§„æ ¼è¦æ±‚ |
|-----|---------|-------|---------|---------|-------|---------|

**æ“ä½œæŒ‰é’®**ï¼ˆæ ¹æ®æƒé™åŠ¨æ€æ˜¾ç¤ºï¼‰ï¼š
- ğŸ”µ **ç¼–è¾‘** - ä»…è‰ç¨¿çŠ¶æ€
- ğŸŸ¡ **å¤„ç†å½’è¿˜** - å€Ÿç”¨ä¸­æˆ–éƒ¨åˆ†å½’è¿˜
- ğŸŸ  **è½¬é‡‡è´­è®¢å•** - æœ‰å‰©ä½™æ•°é‡
- ğŸŸ¢ **å®¡æ ¸é€šè¿‡** - ä»…ç®¡ç†å‘˜ï¼Œè½¬æ¢ä¸­çŠ¶æ€

### å½’è¿˜å¤„ç†é¡µ (`borrow_return.html`)

**ä¿¡æ¯æç¤º**ï¼š
```
â„¹ï¸ å½’è¿˜è¯´æ˜ï¼š
- æ”¯æŒéƒ¨åˆ†å½’è¿˜ï¼šå¯ä»¥åªå½’è¿˜éƒ¨åˆ†æ•°é‡ï¼Œå‰©ä½™æ•°é‡å¯ç»§ç»­å€Ÿç”¨æˆ–è½¬é‡‡è´­
- å½’è¿˜æ•°é‡ä¸èƒ½è¶…è¿‡å‰©ä½™å¯å½’è¿˜æ•°é‡
- å·²è½¬é‡‡è´­çš„æ•°é‡ä¸èƒ½å†å½’è¿˜
```

**æ˜ç»†è¡¨æ ¼**ï¼š
| äº§å“ | å€Ÿç”¨æ•°é‡ | å·²å½’è¿˜ | å·²è½¬é‡‡è´­ | **å¯å½’è¿˜æ•°é‡** | **æœ¬æ¬¡å½’è¿˜æ•°é‡** |
|-----|---------|-------|---------|--------------|----------------|
| äº§å“A | 10 | 3 | 2 | **5** | [è¾“å…¥æ¡†] + "å…¨éƒ¨å½’è¿˜"æŒ‰é’® |

### è½¬é‡‡è´­è¯·æ±‚é¡µ (`borrow_request_conversion.html`)

**ä¿¡æ¯æç¤º**ï¼š
```
âš ï¸ è½¬é‡‡è´­è¯´æ˜ï¼š
- æ‰‹åŠ¨è¾“å…¥ä»·æ ¼ï¼šè½¬é‡‡è´­æ—¶éœ€è¦æ‰‹åŠ¨è¾“å…¥æ¯ä¸ªäº§å“çš„å«ç¨å•ä»·
- éœ€è¦å®¡æ ¸ï¼šæäº¤åéœ€è¦ç®¡ç†å‘˜å®¡æ ¸é€šè¿‡æ‰ä¼šç”Ÿæˆé‡‡è´­è®¢å•
- è‡ªåŠ¨æµç¨‹ï¼šå®¡æ ¸é€šè¿‡åå°†è‡ªåŠ¨ç”Ÿæˆé‡‡è´­è®¢å•ã€å…¥åº“å•å’Œåº”ä»˜è´¦æ¬¾
- éƒ¨åˆ†è½¬æ¢ï¼šå¯ä»¥åªè½¬æ¢éƒ¨åˆ†æ•°é‡ï¼Œå‰©ä½™éƒ¨åˆ†å¯ç»§ç»­å€Ÿç”¨æˆ–å½’è¿˜
```

**æ˜ç»†è¡¨æ ¼**ï¼š
| äº§å“ | å€Ÿç”¨æ•°é‡ | å·²å½’è¿˜ | å¯è½¬é‡‡è´­æ•°é‡ | **è½¬é‡‡è´­æ•°é‡** | **å«ç¨å•ä»·** | å«ç¨å°è®¡ |
|-----|---------|-------|------------|--------------|------------|---------|
| äº§å“A | 10 | 3 | 7 | [è¾“å…¥æ¡†] + "å…¨éƒ¨è½¬æ¢" | [è¾“å…¥æ¡†] Â¥ | Â¥ 0.00 |

**è¡¨å•åº•éƒ¨**ï¼š
```
è½¬é‡‡è´­å¤‡æ³¨: [æ–‡æœ¬æ¡† - å¤šè¡Œ]

[è¿”å›] [æäº¤å®¡æ ¸]
```

**JavaScript åŠŸèƒ½**ï¼š
```javascript
// 1. å®æ—¶è®¡ç®—å°è®¡
function updateSubtotal(itemId) {
    const qty = parseFloat(qtyInput.value) || 0;
    const price = parseFloat(priceInput.value) || 0;
    const subtotal = qty * price;
    subtotalSpan.textContent = subtotal.toFixed(2);
    updateTotal();  // æ›´æ–°æ€»è®¡
}

// 2. è¡¨å•éªŒè¯
form.addEventListener('submit', function(e) {
    // è‡³å°‘é€‰æ‹©ä¸€ä¸ªäº§å“
    // éªŒè¯å•ä»·å¿…å¡«
    // éªŒè¯æ•°é‡ä¸è¶…é™
});
```

---

## ğŸ” å…³é”®ä¸šåŠ¡è§„åˆ™æ€»ç»“

### æ•°é‡ç®¡ç†è§„åˆ™

```python
# 1. å‰©ä½™æ•°é‡è®¡ç®—
remaining_quantity = quantity - returned_quantity - conversion_quantity

# 2. å½’è¿˜æ•°é‡éªŒè¯
if return_qty > remaining_quantity:
    raise Error('å½’è¿˜æ•°é‡ä¸èƒ½è¶…è¿‡å‰©ä½™æ•°é‡')

# 3. è½¬é‡‡è´­æ•°é‡éªŒè¯
if convert_qty > remaining_quantity:
    raise Error('è½¬é‡‡è´­æ•°é‡ä¸èƒ½è¶…è¿‡å‰©ä½™æ•°é‡')

# 4. å…¨éƒ¨å½’è¿˜åˆ¤æ–­
is_fully_returned = (total_remaining_quantity == 0)
```

### çŠ¶æ€æµè½¬è§„åˆ™

```python
# 1. åˆ›å»ºæ—¶ç›´æ¥è¿›å…¥å€Ÿç”¨ä¸­ï¼ˆæ— éœ€å®¡æ ¸ï¼‰
status = 'borrowed'

# 2. å½’è¿˜åçŠ¶æ€æ›´æ–°
if is_fully_returned:
    status = 'fully_returned'
else:
    status = 'partially_returned'

# 3. è½¬é‡‡è´­çŠ¶æ€
# å‘èµ·è¯·æ±‚ â†’ converting
# å®¡æ ¸é€šè¿‡ â†’ converted
```

### åº“å­˜å’Œè´¢åŠ¡è§„åˆ™

```
âŒ å€Ÿç”¨åˆ›å»º â†’ ä¸ç”Ÿæˆåº“å­˜äº‹åŠ¡
âŒ å€Ÿç”¨å½’è¿˜ â†’ ä¸ç”Ÿæˆåº“å­˜äº‹åŠ¡
âœ… è½¬é‡‡è´­å®¡æ ¸é€šè¿‡ â†’ ç”Ÿæˆé‡‡è´­è®¢å•ï¼ˆå¾…å®¡æ ¸ï¼‰
âœ… é‡‡è´­è®¢å•å®¡æ ¸é€šè¿‡ â†’ ç”Ÿæˆå…¥åº“å• + åº”ä»˜è´¦æ¬¾
```

---

## ğŸ“ é¡µé¢è·¯ç”±æ˜ å°„

| åŠŸèƒ½ | URL | è§†å›¾å‡½æ•° | æ¨¡æ¿ |
|-----|-----|---------|------|
| åˆ—è¡¨é¡µ | `/purchase/borrows/` | `borrow_list` | `borrow_list.html` |
| åˆ›å»ºé¡µ | `/purchase/borrows/create/` | `borrow_create` | `borrow_form.html` |
| è¯¦æƒ…é¡µ | `/purchase/borrows/{id}/` | `borrow_detail` | `borrow_detail.html` |
| ç¼–è¾‘é¡µ | `/purchase/borrows/{id}/edit/` | `borrow_update` | `borrow_form.html` |
| å½’è¿˜å¤„ç† | `/purchase/borrows/{id}/return/` | `borrow_return` | `borrow_return.html` |
| è½¬é‡‡è´­è¯·æ±‚ | `/purchase/borrows/{id}/request-conversion/` | `borrow_request_conversion` | `borrow_request_conversion.html` |
| å®¡æ ¸è½¬é‡‡è´­ | `/purchase/borrows/{id}/approve-conversion/` | `borrow_approve_conversion` | (POSTé‡å®šå‘) |

---

## ğŸ¯ å…¸å‹ä¸šåŠ¡åœºæ™¯ä¸¾ä¾‹

### åœºæ™¯ç¤ºä¾‹1ï¼šå€Ÿç”¨åå…¨éƒ¨å½’è¿˜

```
1. åˆ›å»ºå€Ÿç”¨å•
   - å€Ÿç”¨äº§å“Aï¼š10ä¸ª
   - å€Ÿç”¨äº§å“Bï¼š5ä¸ª
   çŠ¶æ€ï¼šborrowed

2. ç¬¬ä¸€æ¬¡å½’è¿˜
   - å½’è¿˜äº§å“Aï¼š10ä¸ªï¼ˆå…¨éƒ¨ï¼‰
   - å½’è¿˜äº§å“Bï¼š3ä¸ªï¼ˆéƒ¨åˆ†ï¼‰
   çŠ¶æ€ï¼špartially_returned
   å‰©ä½™ï¼šäº§å“B 2ä¸ª

3. ç¬¬äºŒæ¬¡å½’è¿˜
   - å½’è¿˜äº§å“Bï¼š2ä¸ªï¼ˆå…¨éƒ¨ï¼‰
   çŠ¶æ€ï¼šfully_returned
   æµç¨‹ç»“æŸ âœ…
```

### åœºæ™¯ç¤ºä¾‹2ï¼šå€Ÿç”¨åéƒ¨åˆ†å½’è¿˜ï¼Œå‰©ä½™è½¬é‡‡è´­

```
1. åˆ›å»ºå€Ÿç”¨å•
   - å€Ÿç”¨äº§å“Aï¼š10ä¸ª
   çŠ¶æ€ï¼šborrowed

2. å½’è¿˜éƒ¨åˆ†
   - å½’è¿˜äº§å“Aï¼š3ä¸ª
   çŠ¶æ€ï¼špartially_returned
   å‰©ä½™ï¼š7ä¸ª

3. å‘èµ·è½¬é‡‡è´­è¯·æ±‚
   - è½¬é‡‡è´­æ•°é‡ï¼š5ä¸ª
   - å«ç¨å•ä»·ï¼šÂ¥100.00
   çŠ¶æ€ï¼šconverting
   å‰©ä½™å¯å€Ÿç”¨ï¼š2ä¸ªï¼ˆæš‚å­˜ï¼‰

4. ç®¡ç†å‘˜å®¡æ ¸é€šè¿‡
   çŠ¶æ€ï¼šconverted
   ç”Ÿæˆï¼šé‡‡è´­è®¢å• PO260106001
   - äº§å“Aï¼š5ä¸ª Ã— Â¥100 = Â¥500
   å‰©ä½™å€Ÿç”¨ï¼š2ä¸ªï¼ˆå¯ç»§ç»­å½’è¿˜ï¼‰
```

### åœºæ™¯ç¤ºä¾‹3ï¼šå€Ÿç”¨åå…¨éƒ¨è½¬é‡‡è´­

```
1. åˆ›å»ºå€Ÿç”¨å•
   - å€Ÿç”¨äº§å“Aï¼š10ä¸ª
   - å€Ÿç”¨äº§å“Bï¼š5ä¸ª
   çŠ¶æ€ï¼šborrowed

2. å‘èµ·è½¬é‡‡è´­è¯·æ±‚ï¼ˆå…¨éƒ¨ï¼‰
   - äº§å“Aï¼š10ä¸ª Ã— Â¥100 = Â¥1000
   - äº§å“Bï¼š5ä¸ª Ã— Â¥50 = Â¥250
   çŠ¶æ€ï¼šconverting

3. ç®¡ç†å‘˜å®¡æ ¸é€šè¿‡
   çŠ¶æ€ï¼šconverted
   ç”Ÿæˆï¼šé‡‡è´­è®¢å• PO260106002
   æ€»é‡‘é¢ï¼šÂ¥1250
   æµç¨‹ç»“æŸ âœ…
```

---

## ğŸ“Š æ•°æ®ç»Ÿè®¡ä¸æŠ¥è¡¨

### åˆ—è¡¨é¡µç»Ÿè®¡

```python
stats = {
    'borrowed_count': å€Ÿç”¨ä¸­æ•°é‡,
    'partially_returned_count': éƒ¨åˆ†å½’è¿˜æ•°é‡,
    'converting_count': å¾…å®¡æ ¸æ•°é‡,
    'converted_count': å·²è½¬é‡‡è´­æ•°é‡,
}
```

### æ˜ç»†é¡µç»Ÿè®¡

```python
total_borrowed_quantity = sum(item.quantity)        # æ€»å€Ÿç”¨æ•°é‡
total_returned_quantity = sum(item.returned_quantity)  # æ€»å½’è¿˜æ•°é‡
total_remaining_quantity = sum(item.remaining_quantity) # æ€»å‰©ä½™æ•°é‡
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### å¼€å‘æ³¨æ„ç‚¹

1. âœ… **äº‹åŠ¡ä¿æŠ¤**ï¼šæ‰€æœ‰å†™æ“ä½œä½¿ç”¨ `@transaction.atomic`
2. âœ… **è½¯åˆ é™¤**ï¼šä½¿ç”¨ BaseModel çš„è½¯åˆ é™¤åŠŸèƒ½
3. âœ… **å®¡è®¡è¿½è¸ª**ï¼šè®°å½• created_byã€updated_by
4. âœ… **å¹‚ç­‰æ€§**ï¼šè½¬é‡‡è´­å®¡æ ¸æ”¯æŒå¹‚ç­‰æ€§æ£€æŸ¥
5. âœ… **Decimal ç²¾åº¦**ï¼šæ•°é‡4ä½ã€ä»·æ ¼2ä½å°æ•°

### ä½¿ç”¨æ³¨æ„ç‚¹

1. âš ï¸ **å€Ÿç”¨ä¸å…¥åº“**ï¼šä»…ç³»ç»Ÿè®°å½•ï¼Œä¸ç”Ÿæˆåº“å­˜äº‹åŠ¡
2. âš ï¸ **æ‰‹åŠ¨å®šä»·**ï¼šè½¬é‡‡è´­æ—¶å¿…é¡»æ‰‹åŠ¨è¾“å…¥ä»·æ ¼
3. âš ï¸ **å®¡æ ¸æƒé™**ï¼šä»…ç®¡ç†å‘˜å¯å®¡æ ¸è½¬é‡‡è´­
4. âš ï¸ **ä¸å¯æ’¤é”€**ï¼šå®¡æ ¸é€šè¿‡åä¸å¯æ’¤é”€
5. âš ï¸ **äºŒæ¬¡å®¡æ ¸**ï¼šè½¬æ¢çš„é‡‡è´­è®¢å•éœ€è¦å†æ¬¡å®¡æ ¸

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- **æµ‹è¯•æŠ¥å‘Š**: `docs/borrow_test_report.md`
- **æµ‹è¯•è®¡åˆ’**: `docs/borrow_test_plan.md`
- **å®ç°è®¡åˆ’**: å‚è€ƒé”€å”®å€Ÿç”¨è®¡åˆ’ `docs/sales_loan_implementation_plan.md`

---

**æ•´ç†å®Œæˆæ—¶é—´**: 2026-01-06
**æ•´ç†äºº**: æµ®æµ®é…± (å¹½æµ®å–µ) à¸…'Ï‰'à¸…
**çŠ¶æ€**: âœ… å·²æ¢³ç†å®Œæˆï¼Œå¯ä½œä¸ºé”€å”®å€Ÿç”¨çš„å‚è€ƒå–µï½
