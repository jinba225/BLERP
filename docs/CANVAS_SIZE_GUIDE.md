# 打印模板画布尺寸快速设置指南

## 🎯 功能概述

在HiPrint打印模板编辑器中，现在可以**快速设置画布尺寸**，包括：
- 📄 预设纸张尺寸（A4、A5、B5等）
- 🔄 横向/纵向切换
- ✏️ 自定义尺寸
- 📐 页边距调整

**所有设置都会实时生效，且保留已添加的元素！**

---

## 🚀 快速使用

### 1. 打开画布尺寸设置

在模板编辑器页面，点击工具栏的 **"画布尺寸"** 按钮：

```
┌─────────────────────────────────────────┐
│ [预览] [测试打印] [画布尺寸] [清空]      │
│                    ↑ 点这里               │
└─────────────────────────────────────────┘
```

### 2. 选择纸张尺寸

在下拉菜单中选择预设纸张：

| 选项 | 尺寸 (宽×高) | 适用场景 |
|------|-------------|----------|
| **A4** | 210mm × 297mm | 常用办公文档、报价单 |
| **A5** | 148mm × 210mm | 便签、小型单据 |
| **B5** | 176mm × 250mm | 中型表单 |
| **Letter** | 216mm × 279mm | 北美标准信纸 |
| **Legal** | 216mm × 356mm | 法律文件 |
| **自定义** | 手动输入 | 特殊尺寸 |

**选择后会自动应用！**

### 3. 切换横向/纵向

点击"方向"下拉菜单：
- **纵向 ↕** - 竖着打印（默认）
- **横向 ↔** - 横着打印

**选择后立即切换画布！**

### 4. 自定义尺寸（可选）

如果需要特殊尺寸：

1. 纸张尺寸选择 **"自定义尺寸"**
2. 在"宽度"和"高度"输入框输入数值（单位：mm）
3. 点击 **"应用"** 按钮

**限制：**
- 最小尺寸：50mm × 50mm
- 最大尺寸：1000mm × 1000mm

### 5. 调整页边距（可选）

在"页边距设置"区域，可以分别设置：
- 上边距 (0-50mm)
- 下边距 (0-50mm)
- 左边距 (0-50mm)
- 右边距 (0-50mm)

**修改后点击"应用"按钮生效。**

---

## 📊 常用场景

### 场景1：报价单 - A4纵向

```
纸张尺寸: A4 (210×297mm)
方向: 纵向 ↕
页边距: 上下左右各 10mm
```

**适用于：** 标准报价单、合同、订单

### 场景2：出货单 - A5横向

```
纸张尺寸: A5 (148×210mm)
方向: 横向 ↔  (实际尺寸变为 210×148mm)
页边距: 上下左右各 5mm
```

**适用于：** 物流单、装箱单、简易发货单

### 场景3：标签 - 自定义尺寸

```
纸张尺寸: 自定义
宽度: 100mm
高度: 150mm
页边距: 上下左右各 2mm
```

**适用于：** 产品标签、条形码标签

### 场景4：长单据 - Legal纵向

```
纸张尺寸: Legal (216×356mm)
方向: 纵向 ↕
页边距: 上下 15mm，左右 10mm
```

**适用于：** 多项明细的长单据、详细报表

---

## 🎨 实际操作示例

### 示例1：从A4纵向改为A4横向

**步骤：**
1. 点击 "画布尺寸" 按钮
2. 纸张尺寸保持 "A4"
3. 方向改为 "横向 ↔"
4. ✅ 画布立即变为 297mm × 210mm

**效果：**
```
变更前：┃      ┃  (210mm宽)
       ┃      ┃
       ┃      ┃
       ┃      ┃
       ┃______┃

变更后：━━━━━━━━━  (297mm宽)
       ┃      ┃
       ┃______┃
```

### 示例2：创建自定义尺寸的标签

**步骤：**
1. 点击 "画布尺寸" 按钮
2. 纸张尺寸选择 "自定义尺寸"
3. 宽度输入：80
4. 高度输入：120
5. 页边距全部改为 3
6. 点击 "应用" 按钮
7. ✅ 创建了 80mm × 120mm 的标签画布

---

## ⚙️ 高级功能

### 1. 保留已有元素

**重要特性：** 修改画布尺寸时，**已添加的所有元素不会丢失**！

工作原理：
```javascript
// 系统会自动：
1. 保存当前所有元素
2. 清除旧画布
3. 创建新尺寸画布
4. 恢复所有元素
```

**注意：** 如果新画布比旧画布小，超出部分的元素可能不可见（但数据仍保留）

### 2. 实时预览

选择预设纸张尺寸时，**不需要点击"应用"按钮**，会自动更新！

```
选择 A5 → 立即变为 148×210mm
切换横向 → 立即变为 210×148mm
```

### 3. 当前画布信息

面板底部会显示当前画布状态：

```
ℹ️ 当前画布: 210mm × 297mm (A4 纵向)
```

实时更新，帮助你确认设置是否正确。

---

## 📏 纸张尺寸速查表

### 常用尺寸对照

| 名称 | 纵向 (宽×高) | 横向 (宽×高) | 备注 |
|------|-------------|-------------|------|
| A4 | 210 × 297 | 297 × 210 | 最常用 |
| A5 | 148 × 210 | 210 × 148 | A4的一半 |
| B5 | 176 × 250 | 250 × 176 | 介于A4和A5之间 |
| Letter | 216 × 279 | 279 × 216 | 美国标准 |
| Legal | 216 × 356 | 356 × 216 | 美国法律文件 |

### 单位换算

```
1 英寸 (inch) = 25.4mm
1 厘米 (cm) = 10mm

Letter (8.5" × 11") ≈ 216mm × 279mm
Legal (8.5" × 14") ≈ 216mm × 356mm
```

---

## ⚠️ 注意事项

### 1. 元素可能超出画布

**问题：** 缩小画布后，某些元素可能超出可见范围

**解决方法：**
- 手动调整元素位置
- 或重新放大画布
- 元素数据不会丢失，只是暂时不可见

### 2. 打印机兼容性

**建议：** 设置画布尺寸时，考虑打印机支持的纸张：

```
常见打印机支持：
✅ A4, A5, Letter - 几乎所有打印机
⚠️ B5, Legal - 部分打印机
❌ 过小或过大的自定义尺寸 - 可能不支持
```

### 3. 页边距影响

**实际可用打印区域 = 画布尺寸 - 页边距**

示例：
```
A4 (210×297mm)
页边距各10mm
实际可用区域: 190×277mm
```

### 4. 保存模板

**重要：** 修改画布尺寸后，**记得保存模板**！

```
修改画布 → 调整元素 → 点击"保存模板"按钮
```

---

## 🛠️ 故障排查

### 问题1：点击"画布尺寸"按钮无反应

**可能原因：**
- 模板未初始化完成

**解决方法：**
1. 等待页面完全加载（看到画布）
2. 刷新页面（Ctrl+F5）
3. 查看浏览器控制台错误

### 问题2：切换尺寸后元素消失

**可能原因：**
- 元素位置超出新画布范围

**解决方法：**
1. 重新放大画布到原尺寸或更大
2. 元素会重新出现
3. 手动调整元素位置到可见区域

### 问题3：自定义尺寸无法应用

**检查项：**
- [ ] 宽度和高度是否 ≥ 50mm
- [ ] 宽度和高度是否 ≤ 1000mm
- [ ] 是否输入了有效数字
- [ ] 是否点击了"应用"按钮

### 问题4：页边距设置不生效

**注意：** 页边距修改后需要点击 **"应用"** 按钮！

**步骤：**
```
修改页边距输入框 → 点击"应用"按钮 → 生效
```

---

## 💡 最佳实践

### 1. 设计顺序建议

```
第一步：确定纸张尺寸和方向
第二步：设置合适的页边距
第三步：拖拽添加元素
第四步：调整元素位置和样式
第五步：保存模板
```

**不要先添加很多元素再改画布！**

### 2. 页边距推荐值

```
报价单/合同: 10-15mm (避免边缘打印不清)
标签: 2-5mm (节省空间)
海报: 20-30mm (留白更美观)
```

### 3. 测试打印

修改画布尺寸后，建议：
```
1. 点击"预览"查看效果
2. 点击"测试打印"验证实际输出
3. 确认无误后保存模板
```

---

## 🎓 技术细节

### JavaScript API

如果需要通过代码控制画布尺寸：

```javascript
// 应用预设纸张
$('#paperSizeSelect').val('a4');
$('#orientationSelect').val('landscape');
applyPaperSize();

// 应用自定义尺寸
$('#canvasWidth').val(300);
$('#canvasHeight').val(400);
applyCustomSize();

// 显示/隐藏面板
showCanvasSizePanel();
hideCanvasSizePanel();
```

### 数据结构

画布配置保存在模板JSON中：

```json
{
  "panels": [{
    "width": 210,
    "height": 297,
    "paperHeader": 10,
    "paperFooter": 10,
    "leftOffset": 10,
    "rightOffset": 10,
    "printElements": [...]
  }]
}
```

---

## 📞 需要帮助？

遇到问题可以：
1. 查看浏览器控制台（F12）的错误日志
2. 参考 `docs/HIPRINT_TEST_GUIDE.md` 测试指南
3. 联系开发团队

---

**更新日期：** 2025-01-07
**版本：** v1.3 - 画布尺寸快速设置功能
**维护者：** BetterLaser ERP 开发团队
