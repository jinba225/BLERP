{% extends 'layouts/base.html' %}
{% block title %}{% if action == 'update' %}编辑仓库{% else %}新建仓库{% endif %} - {{ warehouse.name|default:"新仓库" }} - BetterLaser ERP{% endblock %}

{% block breadcrumb %}
<span class="mx-2 text-gray-400">/</span>
<a href="{% url 'inventory:stock_list' %}" class="text-gray-500 hover:text-gray-700">库存管理</a>
<span class="mx-2 text-gray-400">/</span>
<a href="{% url 'inventory:warehouse_list' %}" class="text-gray-500 hover:text-gray-700">仓库管理</a>
<span class="mx-2 text-gray-400">/</span>
{% if action == 'update' %}
<a href="{% url 'inventory:warehouse_detail' warehouse.pk %}" class="text-gray-500 hover:text-gray-700">{{ warehouse.name }}</a>
<span class="mx-2 text-gray-400">/</span>
<span class="text-gray-900 font-semibold">编辑仓库</span>
{% else %}
<span class="text-gray-900 font-semibold">新建仓库</span>
{% endif %}
{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <div class="mb-6">
        <h3 class="text-2xl font-bold text-gray-900">{% if action == 'update' %}编辑仓库{% else %}新建仓库{% endif %}</h3>
        <p class="text-sm text-gray-600 mt-1">{% if action == 'update' %}修改仓库信息{% else %}创建新的仓库{% endif %}</p>
    </div>

    <div class="bg-white rounded-lg shadow p-6">
        <form method="post" class="space-y-6">
            {% csrf_token %}

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        仓库名称 <span class="text-red-500">*</span>
                    </label>
                    <input type="text"
                           name="name"
                           required
                           value="{% if action == 'update' %}{{ warehouse.name }}{% endif %}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-theme-500 focus:border-theme-500"
                           placeholder="请输入仓库名称">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        仓库编码 <span class="text-red-500">*</span>
                    </label>
                    <input type="text"
                           name="code"
                           required
                           value="{% if action == 'update' %}{{ warehouse.code }}{% endif %}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-theme-500 focus:border-theme-500"
                           placeholder="请输入仓库编码（如：MAIN01）">
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        仓库类型 <span class="text-red-500">*</span>
                    </label>
                    <select name="warehouse_type"
                            required
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-theme-500 focus:border-theme-500">
                        {% for type_code, type_name in warehouse_types %}
                        <option value="{{ type_code }}" {% if action == 'update' and warehouse.warehouse_type == type_code %}selected{% endif %}>{{ type_name }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        管理员
                    </label>
                    <select name="manager"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-theme-500 focus:border-theme-500">
                        <option value="">请选择管理员</option>
                        {% for manager in managers %}
                        <option value="{{ manager.id }}" {% if action == 'update' and warehouse.manager_id == manager.id %}selected{% endif %}>{{ manager.username }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    仓库地址
                </label>
                <textarea name="address"
                          rows="2"
                          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-theme-500 focus:border-theme-500"
                          placeholder="请输入仓库地址">{% if action == 'update' %}{{ warehouse.address }}{% endif %}</textarea>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        联系电话
                    </label>
                    <input type="text"
                           name="phone"
                           value="{% if action == 'update' %}{{ warehouse.phone }}{% endif %}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-theme-500 focus:border-theme-500"
                           placeholder="请输入联系电话">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        容量（m³）
                    </label>
                    <input type="number"
                           name="capacity"
                           min="0"
                           step="0.01"
                           value="{% if action == 'update' %}{{ warehouse.capacity }}{% endif %}"
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-theme-500 focus:border-theme-500"
                           placeholder="请输入仓库容量">
                </div>
            </div>

            <div class="flex items-center">
                <input type="checkbox"
                       name="is_active"
                       id="is_active"
                       {% if action != 'update' or warehouse.is_active %}checked{% endif %}
                       class="h-4 w-4 text-theme-600 focus:ring-theme-500 border-gray-300 rounded">
                <label for="is_active" class="ml-2 block text-sm text-gray-900">
                    启用仓库
                </label>
            </div>

            <div class="flex justify-end space-x-4 pt-6 border-t">
                {% if action == 'update' %}
                <a href="{% url 'inventory:warehouse_detail' warehouse.pk %}" class="btn btn-secondary">
                    <svg class="icon mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
</svg>取消
                </a>
                {% else %}
                <a href="{% url 'inventory:warehouse_list' %}" class="btn btn-secondary">
                    <svg class="icon mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
</svg>取消
                </a>
                {% endif %}
                <button type="submit" class="btn btn-primary">
                    <svg class="icon mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
</svg>保存
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}